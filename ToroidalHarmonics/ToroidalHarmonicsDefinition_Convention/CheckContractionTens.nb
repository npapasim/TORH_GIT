(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    229676,       5886]
NotebookOptionsPosition[    224531,       5731]
NotebookOutlinePosition[    224905,       5747]
CellTagsIndexPosition[    224862,       5744]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "Notation`"}]], "Input",
 CellChangeTimes->{{3.760857651181736*^9, 3.7608576631462946`*^9}}],

Cell[BoxData[
 RowBox[{"Symbolize", "[", 
  TemplateBox[{SubscriptBox["g", "_"]},
   "NotationTemplateTag"], "]"}]], "Input",
 CellChangeTimes->{{3.7608576696296415`*^9, 3.760857671905982*^9}}],

Cell[CellGroupData[{

Cell["Check expressions for the contraction tensors", "Section",
 CellChangeTimes->{{3.7608565815814495`*^9, 3.7608566038226013`*^9}}],

Cell[TextData[StyleBox["Cartesian to toroidal map",
 FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
 CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
  3.760856918908544*^9, 3.7608569348779273`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"XYZ", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"CoordinateTransform", "[", " ", 
     RowBox[{
      RowBox[{"\"\<Toroidal\>\"", " ", "\[Rule]", " ", "\"\<Cartesian\>\""}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", " ", "\[Phi]"}], "}"}]}], 
     "]"}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"Cartesian", " ", "coords", " ", "in", " ", "toroidal"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
   RowBox[{"XYZ", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Y", "[", 
    RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
   RowBox[{"XYZ", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
   RowBox[{"XYZ", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToroToCart", "[", 
   RowBox[{"Vec_", ",", "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], 
  ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
        "\[Eta]"}], "]"}], 
      RowBox[{"Vec", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
        "\[Theta]"}], "]"}], 
      RowBox[{"Vec", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
        "\[Phi]"}], "]"}], 
      RowBox[{"Vec", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
        "\[Eta]"}], "]"}], 
      RowBox[{"Vec", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
        "\[Theta]"}], "]"}], 
      RowBox[{"Vec", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
        "\[Phi]"}], "]"}], 
      RowBox[{"Vec", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Z", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
        "\[Eta]"}], "]"}], 
      RowBox[{"Vec", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Z", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
        "\[Theta]"}], "]"}], 
      RowBox[{"Vec", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Z", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
        "\[Phi]"}], "]"}], 
      RowBox[{"Vec", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}]}], "}"}], 
  RowBox[{"(*", 
   RowBox[{
   "vector", " ", "in", " ", "natrual", " ", "toroidal", " ", "basis", " ", 
    "to", " ", "cartesian", " ", "basis"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.761120095963641*^9, 3.761120254540784*^9}, {
  3.7611203006843443`*^9, 3.7611203089815907`*^9}, {3.761295740147872*^9, 
  3.761295791449997*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"\[FormalA]", " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
     RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
   FractionBox[
    RowBox[{"\[FormalA]", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
     RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
   FractionBox[
    RowBox[{"\[FormalA]", " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
     RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7608569413815656`*^9, 3.761041040121269*^9, 3.761119558872644*^9, 
   3.761120255524217*^9, {3.7611202899714837`*^9, 3.7611203099130573`*^9}, 
   3.7611607516961503`*^9, 3.7612119551115613`*^9, 3.761214022427683*^9, 
   3.761286970384039*^9}]
}, Open  ]],

Cell[TextData[StyleBox["Metric (diagonal only)",
 FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
 CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
  3.760856918908544*^9, 3.7608569348779273`*^9}, {3.7608574388313546`*^9, 
  3.760857471990944*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gMet", "[", 
     RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "comp_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}],
               "}"}], "[", 
             RowBox[{"[", "comp", "]"}], "]"}]}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Y", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}],
               "}"}], "[", 
             RowBox[{"[", "comp", "]"}], "]"}]}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Z", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}],
               "}"}], "[", 
             RowBox[{"[", "comp", "]"}], "]"}]}], "]"}], "2"]}], "]"}], "/.", 
       RowBox[{"\[CapitalEta]", "\[Rule]", "\[Eta]"}]}], "/.", 
      RowBox[{"\[CapitalTheta]", "\[Rule]", "\[Theta]"}]}], "/.", 
     RowBox[{"\[CapitalPhi]", "\[Rule]", "\[Phi]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["g", "\[Eta]\[Eta]"], "[", 
     RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"gMet", "[", 
     RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "1"}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{"as", " ", "components"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["g", "\[Theta]\[Theta]"], "[", 
     RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"gMet", "[", 
     RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "2"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["g", "\[Phi]\[Phi]"], "[", 
     RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"gMet", "[", 
     RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "3"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gTens", "[", 
     RowBox[{
     "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "i_", ",", "j_"}], 
     "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", "\[Equal]", "j"}], ",", 
      RowBox[{"gMet", "[", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "i"}], "]"}], 
      ",", "0"}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{"as", " ", "a", " ", "rank", " ", "3", " ", "tensor"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"jacobian", "[", 
     RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"gMet", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "1"}], "]"}], 
        "*", 
        RowBox[{"gMet", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "2"}], "]"}], 
        "*", 
        RowBox[{"gMet", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "3"}], 
         "]"}]}], "]"}], ",", " ", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
         RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Christoffel", " ", "symbols"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalGamma]\[Eta]", "[", 
     RowBox[{
     "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "\[Beta]_", ",", 
      "\[Gamma]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         FractionBox["1", 
          RowBox[{"gMet", "[", 
           RowBox[{
           "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", ",",
             "1"}], "]"}]], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gTens", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", 
              ",", "1", ",", "\[Gamma]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}],
               "}"}], "[", 
             RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}], "+", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gTens", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", 
              ",", "\[Beta]", ",", "1"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}],
               "}"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gTens", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", 
              ",", "\[Beta]", ",", "\[Gamma]"}], "]"}], ",", 
            "\[CapitalEta]"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"\[CapitalEta]", "\[Rule]", "\[Eta]"}]}], "/.", 
      RowBox[{"\[CapitalTheta]", "\[Rule]", "\[Theta]"}]}], "/.", 
     RowBox[{"\[CapitalPhi]", "\[Rule]", "\[Phi]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"\[CapitalGamma]\[Eta]", "[", 
       RowBox[{
       "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "\[Beta]", ",", 
        "\[Gamma]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalGamma]\[Theta]", "[", 
     RowBox[{
     "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "\[Beta]_", ",", 
      "\[Gamma]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         FractionBox["1", 
          RowBox[{"gMet", "[", 
           RowBox[{
           "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", ",",
             "2"}], "]"}]], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gTens", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", 
              ",", "2", ",", "\[Gamma]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}],
               "}"}], "[", 
             RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}], "+", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gTens", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", 
              ",", "\[Beta]", ",", "2"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}],
               "}"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gTens", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", 
              ",", "\[Beta]", ",", "\[Gamma]"}], "]"}], ",", 
            "\[CapitalTheta]"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"\[CapitalEta]", "\[Rule]", "\[Eta]"}]}], "/.", 
      RowBox[{"\[CapitalTheta]", "\[Rule]", "\[Theta]"}]}], "/.", 
     RowBox[{"\[CapitalPhi]", "\[Rule]", "\[Phi]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"\[CapitalGamma]\[Theta]", "[", 
       RowBox[{
       "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "\[Beta]", ",", 
        "\[Gamma]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalGamma]\[Phi]", "[", 
     RowBox[{
     "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "\[Beta]_", ",", 
      "\[Gamma]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         FractionBox["1", 
          RowBox[{"gMet", "[", 
           RowBox[{
           "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", ",",
             "3"}], "]"}]], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gTens", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", 
              ",", "3", ",", "\[Gamma]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}],
               "}"}], "[", 
             RowBox[{"[", "\[Beta]", "]"}], "]"}]}], "]"}], "+", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gTens", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", 
              ",", "\[Beta]", ",", "3"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}],
               "}"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "]"}], "-", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"gTens", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", 
              ",", "\[Beta]", ",", "\[Gamma]"}], "]"}], ",", 
            "\[CapitalPhi]"}], "]"}]}], ")"}]}], "/.", 
       RowBox[{"\[CapitalEta]", "\[Rule]", "\[Eta]"}]}], "/.", 
      RowBox[{"\[CapitalTheta]", "\[Rule]", "\[Theta]"}]}], "/.", 
     RowBox[{"\[CapitalPhi]", "\[Rule]", "\[Phi]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[CapitalGamma]\[Phi]", "[", 
         RowBox[{
         "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "\[Beta]", ",", 
          "\[Gamma]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
         RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], "//",
     "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "full", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalGamma]", "[", 
     RowBox[{
     "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "\[Alpha]_", ",", 
      "\[Beta]_", ",", "\[Gamma]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "\[Equal]", "1"}], ",", 
       RowBox[{"\[CapitalGamma]\[Eta]", "[", 
        RowBox[{
        "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "\[Beta]", ",", 
         "\[Gamma]"}], "]"}], ",", "0"}], "]"}], "+", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "\[Equal]", "2"}], ",", 
       RowBox[{"\[CapitalGamma]\[Theta]", "[", 
        RowBox[{
        "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "\[Beta]", ",", 
         "\[Gamma]"}], "]"}], ",", "0"}], "]"}], "+", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Alpha]", "\[Equal]", "3"}], ",", 
       RowBox[{"\[CapitalGamma]\[Phi]", "[", 
        RowBox[{
        "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "\[Beta]", ",", 
         "\[Gamma]"}], "]"}], ",", "0"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.7608576260049095`*^9, 3.760857835611228*^9}, {
   3.760858735561391*^9, 3.7608589353120356`*^9}, {3.7608589728157444`*^9, 
   3.7608591598473043`*^9}, {3.760860152832128*^9, 3.7608602811758585`*^9}, {
   3.7608650476271334`*^9, 3.7608650785872583`*^9}, {3.760865209411297*^9, 
   3.7608652274388*^9}, {3.761163902322344*^9, 3.7611642848260183`*^9}, {
   3.76116432088136*^9, 3.761164425488427*^9}, {3.7611645478183355`*^9, 
   3.7611646189235945`*^9}, {3.7611646551048636`*^9, 3.761164852342857*^9}, {
   3.761164883768869*^9, 3.761164885466878*^9}, {3.761164922403714*^9, 
   3.7611650515587893`*^9}, {3.761165126677348*^9, 3.761165165429143*^9}, {
   3.7611652121034*^9, 3.7611652169196424`*^9}, {3.7611652553506227`*^9, 
   3.7611652658875866`*^9}, {3.7611653265788155`*^9, 
   3.7611654891083307`*^9}, {3.7611655732181377`*^9, 
   3.7611658093473396`*^9}, {3.7611658877444253`*^9, 3.7611660663570795`*^9}, 
   3.7611662044509788`*^9, {3.761253610088214*^9, 3.7612536412813416`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"Sinh", "[", "\[Eta]", "]"}], 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], 
      FractionBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], "0"},
     {
      FractionBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sinh", "[", "\[Eta]", "]"}], 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
         RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
           RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", 
             SuperscriptBox["\[FormalA]", "2"], " ", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
               RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], "2"]]}], "-", 
          FractionBox[
           RowBox[{"2", " ", 
            SuperscriptBox["\[FormalA]", "2"], " ", 
            SuperscriptBox[
             RowBox[{"Sinh", "[", "\[Eta]", "]"}], "3"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
              RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], "3"]]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalA]", "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.761164938730358*^9, 3.7611649748637333`*^9}, {
   3.7611650368801985`*^9, 3.7611650521214666`*^9}, 3.7611652276854725`*^9, 
   3.761165267418707*^9, 3.761165394237685*^9, {3.761165426396263*^9, 
   3.7611654511111207`*^9}, 3.7611654907004156`*^9, 3.76116581092843*^9, 
   3.761166069111501*^9, 3.7611662102396607`*^9, 3.7612119576561036`*^9, 
   3.7612140254169693`*^9, 3.7612536420139227`*^9, 3.761286972658931*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
         RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], 
      FractionBox[
       RowBox[{"Sinh", "[", "\[Eta]", "]"}], 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], "0"},
     {
      FractionBox[
       RowBox[{"Sinh", "[", "\[Eta]", "]"}], 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], 
      FractionBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sinh", "[", "\[Eta]", "]"}], "2"]}], 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
         RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.761164938730358*^9, 3.7611649748637333`*^9}, {
   3.7611650368801985`*^9, 3.7611650521214666`*^9}, 3.7611652276854725`*^9, 
   3.761165267418707*^9, 3.761165394237685*^9, {3.761165426396263*^9, 
   3.7611654511111207`*^9}, 3.7611654907004156`*^9, 3.76116581092843*^9, 
   3.761166069111501*^9, 3.7611662102396607`*^9, 3.7612119576561036`*^9, 
   3.7612140254169693`*^9, 3.7612536420139227`*^9, 3.761286972674532*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       RowBox[{"Coth", "[", "\[Eta]", "]"}], "+", 
       FractionBox[
        RowBox[{"Sinh", "[", "\[Eta]", "]"}], 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
         RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}]},
     {"0", "0", 
      FractionBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]},
     {
      RowBox[{
       RowBox[{"Coth", "[", "\[Eta]", "]"}], "+", 
       FractionBox[
        RowBox[{"Sinh", "[", "\[Eta]", "]"}], 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
         RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], 
      FractionBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.761164938730358*^9, 3.7611649748637333`*^9}, {
   3.7611650368801985`*^9, 3.7611650521214666`*^9}, 3.7611652276854725`*^9, 
   3.761165267418707*^9, 3.761165394237685*^9, {3.761165426396263*^9, 
   3.7611654511111207`*^9}, 3.7611654907004156`*^9, 3.76116581092843*^9, 
   3.761166069111501*^9, 3.7611662102396607`*^9, 3.7612119576561036`*^9, 
   3.7612140254169693`*^9, 3.7612536420139227`*^9, 3.7612869728750534`*^9}]
}, Open  ]],

Cell[TextData[StyleBox["Position magnitude and vector (field)",
 FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
 CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
   3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
   3.760857056910141*^9}, 3.761286977872755*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rSq", "[", 
    RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"X", "[", 
        RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"Y", "[", 
        RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"Z", "[", 
        RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "2"]}], 
     ")"}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"position", " ", "vector", " ", "squared"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rCoVec", "[", 
    RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"rSq", "[", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
             "]"}], "2"], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
             "}"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", 
         RowBox[{"\[CapitalEta]", "\[Rule]", "\[Eta]"}]}], "/.", 
        RowBox[{"\[CapitalTheta]", "\[Rule]", "\[Theta]"}]}], "/.", 
       RowBox[{"\[CapitalPhi]", "\[Rule]", "\[Phi]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"position", " ", "co"}], "-", "vector"}], ",", " ", 
    RowBox[{
     RowBox[{"based", " ", "on", " ", 
      SubscriptBox["r", "\[Alpha]"]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Del]", "\[Alpha]"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "/", "2"}], ")"}]}], "=", 
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Alpha]"], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "/", "2"}], ")"}]}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rVec", "[", 
   RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"rCoVec", "[", 
        RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "/", 
      RowBox[{"gMet", "[", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "i"}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"position", " ", 
     RowBox[{"(", 
      RowBox[{"contra", "-", "positive"}], ")"}], " ", 
     RowBox[{"vector", ".", " ", "Using"}], " ", 
     SuperscriptBox["g", "\[Alpha]\[Alpha]"]}], "=", 
    RowBox[{
     RowBox[{"1", "/", 
      SubscriptBox["g", "\[Alpha]\[Alpha]"]}], " ", "for", " ", "diagonal", 
     " ", "metrics"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.76085705870883*^9, 3.7608571215688004`*^9}, {
   3.760857274475494*^9, 3.7608573252064214`*^9}, {3.7608574129911385`*^9, 
   3.76085742073118*^9}, {3.7608592433047705`*^9, 3.7608593569364543`*^9}, {
   3.7608593920056715`*^9, 3.760859602278452*^9}, {3.7608596622339783`*^9, 
   3.7608597415285945`*^9}, 3.760864469658852*^9, {3.7608650344726663`*^9, 
   3.760865037114416*^9}, {3.7608654125510864`*^9, 3.7608654179327483`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "Mathematica", " ", "uses", " ", "normalised", " ", "basis", " ", 
        "vectors", " ", "for", " ", "toroidal", " ", 
        RowBox[{"coordinates", ".", " ", "The"}], " ", "basic", " ", 
        "conversion", " ", "is", " ", "that", " ", "if", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Del]", "\[CapitalPsi]"}], ")"}], "\[Alpha]"]}], "=", 
       RowBox[{
        SuperscriptBox["g", "\[Alpha]\[Beta]"], 
        RowBox[{
         SubscriptBox["\[PartialD]", "\[Beta]"], "\[CapitalPsi]"}], " ", "is",
         " ", "the", " ", "gradient", " ", "in", " ", "my", " ", "natural", 
        " ", "basis"}]}], ",", " ", 
      RowBox[{
       RowBox[{
       "then", " ", "the", " ", "gradient", " ", "in", " ", "normalized", " ",
         "basis", " ", "is", "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox[
          OverscriptBox["e", "^"], "\[Alpha]"], ".", 
         RowBox[{"\[Del]", "\[CapitalPsi]"}]}]}], "=", 
       RowBox[{
        SqrtBox[
         SubscriptBox["g", "\[Alpha]\[Alpha]"]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Del]", "\[CapitalPsi]"}], ")"}], "\[Alpha]"]}]}]}], 
     ")"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "so", " ", "we", " ", "take", " ", "out", " ", "the", " ", "magnitude", 
       " ", "of", " ", "the", " ", "non"}], "-", 
      RowBox[{"normalised", " ", "basis", " ", "vector", " ", 
       SubscriptBox["e", "\[Alpha]"]}]}], "=", 
     RowBox[{
      SqrtBox[
       SubscriptBox["g", "\[Alpha]\[Alpha]"]], 
      SubscriptBox[
       OverscriptBox["e", "^"], "\[Alpha]"]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
        "\"\<Toroidal\>\""}], " ", "]"}], "-", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"\[CapitalPsi]", "[", 
              RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/", 
           RowBox[{"gMet", "[", 
            RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "i"}], 
            "]"}]}], ")"}], "*", 
         SqrtBox[
          RowBox[{"gMet", "[", 
           RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "i"}], 
           "]"}]]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Define", " ", "and", " ", "check", " ", "the", " ", "definition", " ", 
     "of", " ", "the", " ", "position", " ", "vector"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rVecNorm", "[", 
     RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"rVec", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       SqrtBox[
        RowBox[{"gMet", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "i"}], 
         "]"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "test", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"rVecNorm", "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"rSq", "[", 
          RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "2"], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
        "\"\<Toroidal\>\""}], " ", "]"}], "-", 
      RowBox[{"rVecNorm", "[", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.76086447588379*^9, 3.7608648718291025`*^9}, {
  3.7608651097488103`*^9, 3.7608651220453587`*^9}, {3.7608656948421307`*^9, 
  3.7608656955881367`*^9}, {3.7612459625016904`*^9, 3.7612459746557255`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.760864911209543*^9, {3.760865106545397*^9, 3.7608651145219755`*^9}, 
   3.76086515127742*^9, 3.760865246737981*^9, 3.760865426846486*^9, 
   3.7608656967481728`*^9, 3.7610410625372066`*^9, 3.7611195716023493`*^9, 
   3.761160768100752*^9, 3.761211970137952*^9, 3.7612140375330253`*^9, 
   3.7612459759709706`*^9, 3.761286992429064*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"\[FormalA]", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
     RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
   FractionBox[
    RowBox[{"\[FormalA]", " ", 
     RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
     RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.760864911209543*^9, {3.760865106545397*^9, 3.7608651145219755`*^9}, 
   3.76086515127742*^9, 3.760865246737981*^9, 3.760865426846486*^9, 
   3.7608656967481728`*^9, 3.7610410625372066`*^9, 3.7611195716023493`*^9, 
   3.761160768100752*^9, 3.761211970137952*^9, 3.7612140375330253`*^9, 
   3.7612459759709706`*^9, 3.7612869925478616`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.760864911209543*^9, {3.760865106545397*^9, 3.7608651145219755`*^9}, 
   3.76086515127742*^9, 3.760865246737981*^9, 3.760865426846486*^9, 
   3.7608656967481728`*^9, 3.7610410625372066`*^9, 3.7611195716023493`*^9, 
   3.761160768100752*^9, 3.761211970137952*^9, 3.7612140375330253`*^9, 
   3.7612459759709706`*^9, 3.7612869926612654`*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["\[Del].F term - check the correcteness of the expression for this \
term, only the ",
  FontColor->RGBColor[1., 0.5019607843137255, 0.]],
 StyleBox["r",
  FontWeight->"Bold",
  FontColor->RGBColor[1., 0.5019607843137255, 0.]],
 StyleBox["\[CapitalPsi] will make a contribution here",
  FontColor->RGBColor[1., 0.5019607843137255, 0.]]
}], "Text",
 CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
  3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
  3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
  3.7608599456415024`*^9, 3.760859989231761*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"divF", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Div", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"rVecNorm", "[", 
        RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], " ", "a", 
       " ", 
       RowBox[{"\[CapitalPsi]", "[", 
        RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", " ", 
      "\"\<Toroidal\>\""}], "]"}], ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myDiv", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"jacobian", "[", 
            RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"rVec", "[", 
               RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", "a", " ", 
             RowBox[{"\[CapitalPsi]", "[", 
              RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], 
            ")"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], 
        RowBox[{"jacobian", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"sanity", " ", "check"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"divF", "-", "myDiv"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7608598462474627`*^9, 3.760859931196434*^9}, {
  3.7608600239927964`*^9, 3.7608600631448507`*^9}, {3.7608606233325553`*^9, 
  3.7608606295692625`*^9}, {3.7608625202340937`*^9, 3.76086252072875*^9}, {
  3.7608625743462706`*^9, 3.7608625834567127`*^9}, {3.760866005786316*^9, 
  3.760866102586969*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", 
     RowBox[{"\[CapitalPsi]", "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sinh", "[", "\[Eta]", "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.760859932305264*^9, 3.760860065134791*^9, {3.760860625365441*^9, 
   3.760860631205884*^9}, 3.7608625318708167`*^9, 3.760862592068754*^9, 
   3.76086266283706*^9, 3.760865724912635*^9, {3.7608660071195087`*^9, 
   3.76086606229611*^9}, 3.760866103744911*^9, 3.7610410688871145`*^9, 
   3.7611195751683073`*^9, 3.7611607723373437`*^9, 3.7612119727854347`*^9, 
   3.7612140402694597`*^9, 3.7612869961242523`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", 
     RowBox[{"\[CapitalPsi]", "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Sinh", "[", "\[Eta]", "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.760859932305264*^9, 3.760860065134791*^9, {3.760860625365441*^9, 
   3.760860631205884*^9}, 3.7608625318708167`*^9, 3.760862592068754*^9, 
   3.76086266283706*^9, 3.760865724912635*^9, {3.7608660071195087`*^9, 
   3.76086606229611*^9}, 3.760866103744911*^9, 3.7610410688871145`*^9, 
   3.7611195751683073`*^9, 3.7611607723373437`*^9, 3.7612119727854347`*^9, 
   3.7612140402694597`*^9, 3.7612869963716593`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.760859932305264*^9, 3.760860065134791*^9, {3.760860625365441*^9, 
   3.760860631205884*^9}, 3.7608625318708167`*^9, 3.760862592068754*^9, 
   3.76086266283706*^9, 3.760865724912635*^9, {3.7608660071195087`*^9, 
   3.76086606229611*^9}, 3.760866103744911*^9, 3.7610410688871145`*^9, 
   3.7611195751683073`*^9, 3.7611607723373437`*^9, 3.7612119727854347`*^9, 
   3.7612140402694597`*^9, 3.7612869963716593`*^9}]
}, Open  ]],

Cell[TextData[StyleBox["Define scalar toroidal harmonics",
 FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
 CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
  3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
  3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
  3.7608599456415024`*^9, 3.760859989231761*^9}, {3.7608664456516542`*^9, 
  3.7608664545389132`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[CapitalPsi]", ",", "PQ"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PQ", "[", 
    RowBox[{"\[Eta]_", 
     StyleBox[",",
      FontWeight->"Plain"], "n_", ",", "m_", ",", "\[Lambda]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[Lambda]", "\[Equal]", "1"}], ",", " ", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"n", "-", 
         FractionBox["1", "2"]}], ",", " ", "m", ",", " ", "3", ",", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], "]"}], ",", "0"}], "]"}], "+", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[Lambda]", "\[Equal]", "2"}], ",", " ", 
      RowBox[{"LegendreQ", "[", 
       RowBox[{
        RowBox[{"n", "-", 
         FractionBox["1", "2"]}], ",", " ", "m", ",", " ", "3", ",", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], "]"}], ",", "0"}], "]"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPsi]", "[", 
   RowBox[{
   "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
    "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{
   SqrtBox[
    RowBox[{
     RowBox[{"Cosh", "[", "\[Eta]", "]"}], "-", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]], " ", 
   RowBox[{"PQ", "[", 
    RowBox[{"\[Eta]", 
     StyleBox[",",
      FontWeight->"Plain"], "n", ",", "m", ",", "\[Lambda]"}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "n", " ", "\[Theta]"}], "]"}], " ", 
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "m", " ", "\[Phi]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{
  3.760866457562731*^9, {3.761041556778581*^9, 3.7610416244647236`*^9}, {
   3.761041912747326*^9, 3.761041928443433*^9}, {3.7610420194518504`*^9, 
   3.7610420228240356`*^9}, {3.761042134138364*^9, 3.7610421824068537`*^9}}],

Cell[TextData[StyleBox["\[Del].F term - numerical check. Generate many \
expressions for Python",
 FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
 CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
  3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
  3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
  3.7608599456415024`*^9, 3.760859989231761*^9}, {3.7608663060840344`*^9, 
  3.7608663183868923`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"divr\[CapitalPsi]", "[", 
   RowBox[{
   "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
    "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Div", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rVecNorm", "[", 
           RowBox[{
           "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
           "]"}], "  ", 
          RowBox[{"\[CapitalPsi]", "[", 
           RowBox[{
           "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", ",",
             " ", "n", ",", " ", "m", ",", " ", "\[Lambda]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
          "}"}], ",", " ", "\"\<Toroidal\>\""}], "]"}], "/.", 
       RowBox[{"\[CapitalEta]", "\[Rule]", "\[Eta]"}]}], "/.", 
      RowBox[{"\[CapitalTheta]", "\[Rule]", "\[Theta]"}]}], "/.", 
     RowBox[{"\[CapitalPhi]", "\[Rule]", "\[Phi]"}]}], ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.760866519965376*^9, 3.7608666464591064`*^9}, 
   3.7608667067706823`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"divr\[CapitalPsi]", "[", 
  RowBox[{
  "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.760866660438737*^9, 3.7608666668259525`*^9}, 
   3.760866716674806*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"n", " ", "\[Theta]"}], "+", 
      RowBox[{"m", " ", "\[Phi]"}]}], ")"}]}]], " ", 
  SqrtBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "m"}], "-", 
       RowBox[{"2", " ", "n"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"LegendreP", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], "+", "n"}], ",", "m", ",", "3", ",", 
       RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"LegendreP", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], "+", "n"}], ",", "m", ",", "3", ",", 
       RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"5", "+", 
       RowBox[{"2", " ", "n", " ", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.7608666675939713`*^9, 3.7608667172620087`*^9, 
  3.760866881526578*^9, 3.761041629119026*^9, 3.7610420674053802`*^9, 
  3.761042192652326*^9, 3.7611195924244213`*^9, 3.761214050533592*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tryCount", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numData", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "tryCount"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"5", "+", 
         RowBox[{"2", "*", "2"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iTry", "=", "1"}], ",", 
    RowBox[{"iTry", "<=", "tryCount"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rand\[Eta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0.001", ",", " ", "10"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Theta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Phi]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "*", "\[Pi]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"randn", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "30"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"randm", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "30"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"basic", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"divr\[CapitalPsi]First", "=", 
      RowBox[{"divr\[CapitalPsi]", "[", 
       RowBox[{
       "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "randn", 
        ",", "randm", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"divr\[CapitalPsi]Second", "=", 
      RowBox[{"divr\[CapitalPsi]", "[", 
       RowBox[{
       "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "randn", 
        ",", "randm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"save", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "rand\[Eta]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", "rand\[Theta]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", "rand\[Phi]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", "randn"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}], "=", "randm"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iOffset", " ", "=", " ", "5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"now", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "divr\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "2"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "divr\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "3"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "divr\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "4"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "divr\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iTry", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<C:\\\\Users\\\\Vassili Savinov\\\\Dropbox\\\\DARPA_Work\\\\TORH_GIT\\\
\\ToroidalHarmonics\\\\ToroidalHarmonicsDefinition_Convention\\\\contrTens_\
div_rPsi.csv\>\"", ",", "numData", ",", "\"\<CSV\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.760866393884334*^9, 3.7608663952761917`*^9}, {
  3.7608664764699373`*^9, 3.760866476794617*^9}, {3.760866731274129*^9, 
  3.760866829554427*^9}, {3.760866906000129*^9, 3.7608669145198784`*^9}, {
  3.760867501156725*^9, 3.76086751089869*^9}}],

Cell[TextData[StyleBox["Define derivatives of scalar toroidal harmonics",
 FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
 CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
  3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
  3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
  3.7608599456415024`*^9, 3.760859989231761*^9}, {3.7608664456516542`*^9, 
  3.7608664545389132`*^9}, {3.76104140517836*^9, 3.761041413417799*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"first", " ", "check"}], "*)"}]], "Input",
 CellChangeTimes->{{3.761041414654855*^9, 3.761041419673079*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"D\[CapitalPsi]D\[Eta]", "[", 
   RowBox[{
   "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
    "\[Lambda]_", ",", "\[CapitalPsi]F_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"Cosh", "[", "\[Eta]", "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "n"}], " ", "+", "1"}], ")"}], 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]}], ")"}]}], "-", "1"}], 
      RowBox[{"2", " ", 
       RowBox[{"Sinh", "[", "\[Eta]", "]"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cosh", "[", "\[Eta]", "]"}], "-", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}]], ")"}], 
    RowBox[{"\[CapitalPsi]F", "[", 
     RowBox[{
     "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
      "\[Lambda]"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "+", 
         FractionBox["1", "2"], "-", "m"}], ")"}], 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "I"}], " ", "\[Theta]"}], "]"}]}], 
      RowBox[{"Sinh", "[", "\[Eta]", "]"}]], ")"}], 
    RowBox[{"\[CapitalPsi]F", "[", 
     RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
      RowBox[{"n", "+", "1"}], ",", "m", ",", "\[Lambda]"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"\[CapitalPsi]", "[", 
      RowBox[{
      "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
       "\[Lambda]"}], "]"}], ",", "\[Eta]"}], "]"}], "-", 
   RowBox[{"D\[CapitalPsi]D\[Eta]", "[", 
    RowBox[{
    "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
     "\[Lambda]", ",", "\[CapitalPsi]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D\[CapitalPsi]D\[Theta]", "[", 
   RowBox[{
   "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
    "\[Lambda]_", ",", "\[CapitalPsi]F_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"2", " ", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cosh", "[", "\[Eta]", "]"}], "-", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}]], "+", 
     RowBox[{"I", " ", "n"}]}], ")"}], 
   RowBox[{"\[CapitalPsi]F", "[", 
    RowBox[{
    "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
     "\[Lambda]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"\[CapitalPsi]", "[", 
      RowBox[{
      "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
       "\[Lambda]"}], "]"}], ",", "\[Theta]"}], "]"}], "-", 
   RowBox[{"D\[CapitalPsi]D\[Theta]", "[", 
    RowBox[{
    "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
     "\[Lambda]", ",", "\[CapitalPsi]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D\[CapitalPsi]D\[Phi]", "[", 
   RowBox[{
   "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
    "\[Lambda]_", ",", "\[CapitalPsi]F_"}], "]"}], ":=", 
  RowBox[{"I", " ", "m", " ", 
   RowBox[{"\[CapitalPsi]F", "[", 
    RowBox[{
    "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
     "\[Lambda]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"\[CapitalPsi]", "[", 
      RowBox[{
      "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
       "\[Lambda]"}], "]"}], ",", "\[Phi]"}], "]"}], "-", 
   RowBox[{"D\[CapitalPsi]D\[Phi]", "[", 
    RowBox[{
    "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
     "\[Lambda]", ",", "\[CapitalPsi]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.76104146058525*^9, 3.761041525290891*^9}, {
  3.761041656282894*^9, 3.7610417159633055`*^9}, {3.761041828775709*^9, 
  3.761041887691839*^9}, {3.76104223103911*^9, 3.7610423672162256`*^9}, {
  3.761042407252537*^9, 3.761042512880994*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.761042207621689*^9, 3.761042240967166*^9, 
  3.761042300613993*^9, 3.761042475465008*^9, 3.76104251360753*^9, 
  3.7611196041976743`*^9, 3.7611607921669645`*^9, 3.7612119890481195`*^9, 
  3.761214057608523*^9, 3.7612870088046293`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.761042207621689*^9, 3.761042240967166*^9, 
  3.761042300613993*^9, 3.761042475465008*^9, 3.76104251360753*^9, 
  3.7611196041976743`*^9, 3.7611607921669645`*^9, 3.7612119890481195`*^9, 
  3.761214057608523*^9, 3.7612870088046293`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.761042207621689*^9, 3.761042240967166*^9, 
  3.761042300613993*^9, 3.761042475465008*^9, 3.76104251360753*^9, 
  3.7611196041976743`*^9, 3.7611607921669645`*^9, 3.7612119890481195`*^9, 
  3.761214057608523*^9, 3.7612870088046293`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Now", " ", "introduce", " ", "the", " ", "functions", " ", "that", " ", 
   "will", " ", "hide", " ", "the", " ", "toroidal", " ", "harmonics", " ", 
   "and", " ", "keep", " ", "everything", " ", "analytical"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.761042521679226*^9, 3.761042552834648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
     RowBox[{
     "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
      "\[Lambda]_", ",", "\[CapitalPsi]F_"}], "]"}], ":=", 
    RowBox[{"\[CapitalPsi]F", "[", 
     RowBox[{
     "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
      "\[Lambda]"}], "]"}]}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"not", " ", "needed"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "\[CapitalPsi]\[CapitalPsi]", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "]"}], "[", "\[CapitalPsi]\[CapitalPsi]", "]"}], "[", 
      RowBox[{
      "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
       "\[Lambda]_"}], "]"}], ":=", 
     RowBox[{"D\[CapitalPsi]D\[Eta]", "[", 
      RowBox[{
      "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
       "\[Lambda]", ",", "\[CapitalPsi]\[CapitalPsi]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "]"}], "[", "\[CapitalPsi]\[CapitalPsi]", "]"}], "[", 
      RowBox[{
      "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
       "\[Lambda]_"}], "]"}], ":=", 
     RowBox[{"D\[CapitalPsi]D\[Theta]", "[", 
      RowBox[{
      "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
       "\[Lambda]", ",", "\[CapitalPsi]\[CapitalPsi]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
        "]"}], "[", "\[CapitalPsi]\[CapitalPsi]", "]"}], "[", 
      RowBox[{
      "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
       "\[Lambda]_"}], "]"}], ":=", 
     RowBox[{"D\[CapitalPsi]D\[Phi]", "[", 
      RowBox[{
      "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
       "\[Lambda]", ",", "\[CapitalPsi]\[CapitalPsi]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7610425574479065`*^9, 3.7610425999717607`*^9}, {
  3.7610426309938745`*^9, 3.761042633866338*^9}, {3.761042683980448*^9, 
  3.7610427044153414`*^9}, {3.76104273776186*^9, 3.7610428160675335`*^9}, {
  3.761043008683522*^9, 3.761043068125741*^9}, {3.7610433638565583`*^9, 
  3.761043392280984*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"check", " ", "again"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{
         "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
          "\[Lambda]"}], "]"}], ",", "\[Eta]"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
         RowBox[{
         "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
          "\[Lambda]"}], "]"}], ",", "\[Eta]"}], "]"}]}], "/.", 
     RowBox[{"\[CapitalPsi]\[CapitalPsi]", "\[Rule]", "\[CapitalPsi]"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{
         "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
          "\[Lambda]"}], "]"}], ",", "\[Theta]"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
         RowBox[{
         "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
          "\[Lambda]"}], "]"}], ",", "\[Theta]"}], "]"}]}], "/.", 
     RowBox[{"\[CapitalPsi]\[CapitalPsi]", "\[Rule]", "\[CapitalPsi]"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{
         "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
          "\[Lambda]"}], "]"}], ",", "\[Phi]"}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
         RowBox[{
         "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
          "\[Lambda]"}], "]"}], ",", "\[Phi]"}], "]"}]}], "/.", 
     RowBox[{"\[CapitalPsi]\[CapitalPsi]", "\[Rule]", "\[CapitalPsi]"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.761043411543746*^9, 3.761043536090126*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.761043487935957*^9, 3.761043536676279*^9}, 
   3.7610496591950827`*^9, 3.761119613608282*^9, 3.7611608000924206`*^9, 
   3.7612119981698904`*^9, 3.7612140644595966`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.761043487935957*^9, 3.761043536676279*^9}, 
   3.7610496591950827`*^9, 3.761119613608282*^9, 3.7611608000924206`*^9, 
   3.7612119981698904`*^9, 3.7612140644646063`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.761043487935957*^9, 3.761043536676279*^9}, 
   3.7610496591950827`*^9, 3.761119613608282*^9, 3.7611608000924206`*^9, 
   3.7612119981698904`*^9, 3.7612140644676127`*^9}]
}, Open  ]],

Cell[BoxData[Cell[TextData[StyleBox["Define angular momentum operator in \
toroidal coordinates and the angular momentum of toroidal harmomnics",
  FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
  CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
   3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
   3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
   3.7608599456415024`*^9, 3.760859989231761*^9}, {3.7608664456516542`*^9, 
   3.7608664545389132`*^9}, {3.76104140517836*^9, 
   3.761041413417799*^9}}]], "Input",
 CellChangeTimes->{{3.7610414509025135`*^9, 3.761041457654853*^9}, 
   3.761041497643795*^9, {3.761043551546646*^9, 3.7610435728156757`*^9}, {
   3.7610710714895697`*^9, 3.761071083276402*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["L", "\[Alpha]"], "f"}], "=", 
     RowBox[{
      RowBox[{"-", "I"}], 
      FractionBox[
       SuperscriptBox["\[Epsilon]", "\[Alpha]\[Beta]\[Gamma]"], 
       SqrtBox["g"]], 
      SubscriptBox["r", "\[Beta]"], 
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Gamma]"], "f"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"NB", "!"}], " ", "this", " ", "only", " ", "works", " ", "for", 
     " ", "the", " ", "scalar", " ", "case"}], ",", " ", 
    RowBox[{
    "for", " ", "vectors", " ", "we", " ", "need", " ", "something", " ", 
     "else"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AngMomScal", "[", 
     RowBox[{"scalF_", ",", "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"-", "I"}], 
          RowBox[{"jacobian", "[", 
           RowBox[{
           "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
           "]"}]], 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
                 RowBox[{"[", "\[Alpha]", "]"}], "]"}], "[", 
                RowBox[{"[", "\[Beta]", "]"}], "]"}], "[", 
               RowBox[{"[", "\[Gamma]", "]"}], "]"}], 
              RowBox[{
               RowBox[{"rCoVec", "[", 
                RowBox[{
                "\[CapitalEta]", ",", "\[CapitalTheta]", ",", 
                 "\[CapitalPhi]"}], "]"}], "[", 
               RowBox[{"[", "\[Beta]", "]"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Gamma]", "\[Equal]", "1"}], ",", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"scalF", "[", 
                    RowBox[{
                    "\[CapitalEta]", ",", "\[CapitalTheta]", ",", 
                    "\[CapitalPhi]"}], "]"}], ",", "\[CapitalEta]"}], "]"}], 
                  ",", "0"}], "]"}], "+", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Gamma]", "\[Equal]", "2"}], ",", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"scalF", "[", 
                    RowBox[{
                    "\[CapitalEta]", ",", "\[CapitalTheta]", ",", 
                    "\[CapitalPhi]"}], "]"}], ",", "\[CapitalTheta]"}], "]"}],
                   ",", "0"}], "]"}], "+", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"\[Gamma]", "\[Equal]", "3"}], ",", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"scalF", "[", 
                    RowBox[{
                    "\[CapitalEta]", ",", "\[CapitalTheta]", ",", 
                    "\[CapitalPhi]"}], "]"}], ",", "\[CapitalPhi]"}], "]"}], 
                  ",", "0"}], "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], "]"}],
        "/.", 
       RowBox[{"\[CapitalEta]", "\[Rule]", "\[Eta]"}]}], "/.", 
      RowBox[{"\[CapitalTheta]", "\[Rule]", "\[Theta]"}]}], "/.", 
     RowBox[{"\[CapitalPhi]", "\[Rule]", "\[Phi]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AngMomScalNorm", "[", 
     RowBox[{"scalF_", ",", "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], 
     "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"AngMomScal", "[", 
         RowBox[{"scalF", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], 
         "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       SqrtBox[
        RowBox[{"gMet", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "i"}], 
         "]"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L\[CapitalPsi]\[CapitalPsi]", "[", 
     RowBox[{
     "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
      "\[Lambda]_"}], "]"}], ":=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"AngMomScal", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
           "}"}], ",", 
          RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
           RowBox[{
           "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", ",",
             "n", ",", "m", ",", "\[Lambda]"}], "]"}]}], "]"}], ",", "\[Eta]",
         ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
         RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
         RowBox[{"\[Phi]", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{
    "angular", " ", "momentum", " ", "operaotr", " ", "of", " ", "the", " ", 
     "toroidal", " ", "harmonic"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L\[CapitalPsi]\[CapitalPsi]Norm", "[", 
     RowBox[{
     "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
      "\[Lambda]_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"L\[CapitalPsi]\[CapitalPsi]", "[", 
         RowBox[{
         "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
          "\[Lambda]"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       SqrtBox[
        RowBox[{"gMet", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "i"}], 
         "]"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7610437320331755`*^9, 3.7610437597257304`*^9}, {
   3.76104429864176*^9, 3.761044363380177*^9}, {3.7610444582336855`*^9, 
   3.7610444587700796`*^9}, {3.7610444907150106`*^9, 3.761044715955517*^9}, {
   3.761048137520133*^9, 3.761048175553647*^9}, {3.7610489083494287`*^9, 
   3.7610489104446363`*^9}, {3.7610489678335223`*^9, 
   3.7610491145313687`*^9}, {3.761049304043435*^9, 3.7610493601356254`*^9}, 
   3.7610494551770215`*^9, {3.7610495812207284`*^9, 3.7610496070522943`*^9}, {
   3.7610496732635307`*^9, 3.7610496798016343`*^9}, {3.761069801566676*^9, 
   3.761070026721595*^9}, {3.7610704823027945`*^9, 3.7610704834838142`*^9}, {
   3.761070665555808*^9, 3.7610707789213715`*^9}, {3.7610708110666494`*^9, 
   3.76107087266699*^9}, {3.7610709341929502`*^9, 3.761070994207309*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"curlL\[CapitalPsi]\[CapitalPsi]Norm", "[", 
   RowBox[{
   "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
    "\[Lambda]_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Curl", "[", 
     RowBox[{
      RowBox[{"L\[CapitalPsi]\[CapitalPsi]Norm", "[", 
       RowBox[{
       "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
        "\[Lambda]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", " ", 
      "\"\<Toroidal\>\""}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7610714084710846`*^9, 3.7610714857707753`*^9}, {
  3.7610715170443854`*^9, 3.76107153743552*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"L\[CapitalPsi]\[CapitalPsi]", "[", 
   RowBox[{
   "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
    "\[Lambda]"}], "]"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curlL\[CapitalPsi]\[CapitalPsi]Norm", "[", 
   RowBox[{
   "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
    "\[Lambda]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7610707848614902`*^9, 3.7610708017567883`*^9}, {
  3.7610708447914248`*^9, 3.76107084742037*^9}, {3.761071493708728*^9, 
  3.7610715060439754`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
           RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], " ", 
         RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
          RowBox[{
          "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
           "\[Lambda]"}], "]"}]}], "\[FormalA]"]},
      {
       FractionBox[
        RowBox[{"m", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], " ", 
         RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
          RowBox[{
          "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
           "\[Lambda]"}], "]"}]}], "\[FormalA]"]},
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Csch", "[", "\[Eta]", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", " ", "n"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"Cosh", "[", 
                 RowBox[{"2", " ", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
             RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
              RowBox[{
              "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", 
               ",", "\[Lambda]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]]}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "m"}], "-", 
               RowBox[{"2", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
             RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
              RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
               RowBox[{"1", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
              "]"}]}]}], ")"}]}], 
         RowBox[{"4", " ", "\[FormalA]"}]]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.761070804132128*^9, {3.7610708404487453`*^9, 3.7610708480690775`*^9}, {
   3.76107149992687*^9, 3.7610715071468554`*^9}, 3.761071541566392*^9, 
   3.761119627409377*^9, 3.761160815822409*^9, 3.7612120190789113`*^9, 
   3.761214077392189*^9, 3.7612870271248198`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
          RowBox[{"Csch", "[", "\[Eta]", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]]}], "+", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["m", "2"]}], "-", 
               RowBox[{"8", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                SuperscriptBox["m", "2"]}], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                SuperscriptBox["m", "2"]}], "-", 
               RowBox[{"2", " ", "n"}], "+", 
               RowBox[{"6", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                "n"}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                "n"}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                SuperscriptBox["n", "2"]}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                SuperscriptBox["n", "2"]}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["m", "2"]}], "+", 
                  SuperscriptBox["n", "2"], "+", 
                  RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], 
                   " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m", "2"]}], "-", 
                    RowBox[{"3", " ", "n"}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["n", "2"]}]}], ")"}]}]}], ")"}], " ", 
                RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], "-", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", "n"}], "+", 
                  RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], 
                   " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"2", " ", "n"}]}], ")"}]}]}], ")"}], " ", 
                RowBox[{"Cosh", "[", 
                 RowBox[{"2", " ", "\[Eta]"}], "]"}]}], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], " ", "n", " ", 
                RowBox[{"Cosh", "[", 
                 RowBox[{"3", " ", "\[Eta]"}], "]"}]}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                SuperscriptBox["n", "2"], " ", 
                RowBox[{"Cosh", "[", 
                 RowBox[{"3", " ", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
             RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
              RowBox[{
              "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", 
               ",", "\[Lambda]"}], "]"}]}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "m"}], "-", 
               RowBox[{"2", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "+", 
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Theta]"}], "]"}], "-", 
               RowBox[{"4", " ", 
                RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], "+", 
                  RowBox[{"\[ImaginaryI]", " ", "n", " ", 
                   RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "+", 
               RowBox[{"2", " ", "\[ImaginaryI]", " ", "n", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], ")"}], " ", 
             RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
              RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
               RowBox[{"1", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
              "]"}]}]}], ")"}]}], 
         RowBox[{"16", " ", "\[FormalA]"}]]}]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], " ", 
         RowBox[{"Csch", "[", "\[Eta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "\[Theta]"}]], 
             " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]]}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], 
                   " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "n"}]}], ")"}]}], "-", 
                  RowBox[{"2", " ", "n", " ", 
                   RowBox[{"Cosh", "[", 
                    RowBox[{"2", " ", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
                RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                 RowBox[{
                 "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m",
                   ",", "\[Lambda]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]]}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", "m"}], "-", 
                  RowBox[{"2", " ", "n"}]}], ")"}], " ", 
                RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
                RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                 RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
                  RowBox[{"1", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
                 "]"}]}]}], ")"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "\[Theta]"}]], 
            " ", 
            RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"2", " ", "n"}]}], ")"}]}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"Cosh", "[", 
                   RowBox[{"2", " ", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
               RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                RowBox[{
                "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", 
                 ",", "\[Lambda]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]]}], 
                ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"2", " ", "m"}], "-", 
                 RowBox[{"2", " ", "n"}]}], ")"}], " ", 
               RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
               RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
                 RowBox[{"1", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
                "]"}]}]}], ")"}]}], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "\[Theta]"}]], 
             " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox[
                RowBox[{"Coth", "[", "\[Eta]", "]"}], "2"], "+", 
               RowBox[{
                RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
                RowBox[{"Csch", "[", "\[Eta]", "]"}]}]}], ")"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], 
                   " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "n"}]}], ")"}]}], "-", 
                  RowBox[{"2", " ", "n", " ", 
                   RowBox[{"Cosh", "[", 
                    RowBox[{"2", " ", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
                RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                 RowBox[{
                 "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m",
                   ",", "\[Lambda]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]]}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", "m"}], "-", 
                  RowBox[{"2", " ", "n"}]}], ")"}], " ", 
                RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
                RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                 RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
                  RowBox[{"1", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
                 "]"}]}]}], ")"}]}], 
            RowBox[{
             RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", "\[FormalA]", 
              " ", 
              SuperscriptBox["m", "2"], " ", 
              RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
              RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
               RowBox[{
               "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", 
                ",", "\[Lambda]"}], "]"}]}], "+", 
             FractionBox[
              RowBox[{"\[FormalA]", " ", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "\[Theta]"}]],
                " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{
                  RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                  RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]}], ")"}], " ", 
               RowBox[{"Csch", "[", "\[Eta]", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]]}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], 
                    " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "n"}]}], ")"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"Cosh", "[", 
                    RowBox[{"2", " ", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
                  RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                   RowBox[{
                   "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", 
                    "m", ",", "\[Lambda]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]]}], 
                   ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "m"}], "-", 
                    RowBox[{"2", " ", "n"}]}], ")"}], " ", 
                  RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
                  RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                   RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
                    RowBox[{"1", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
                   "]"}]}]}], ")"}]}], 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
               RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "\[FormalA]"], "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "\[Theta]"}]], 
             " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
               RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], " ", "n", " ", 
                RowBox[{"Sinh", "[", 
                 RowBox[{"2", " ", "\[Eta]"}], "]"}], " ", 
                RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                 RowBox[{
                 "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m",
                   ",", "\[Lambda]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]]}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", "m"}], "-", 
                  RowBox[{"2", " ", "n"}]}], ")"}], " ", 
                RowBox[{"Sinh", "[", "\[Eta]", "]"}], " ", 
                RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                 RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
                  RowBox[{"1", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
                 "]"}]}], "+", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], 
                   " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "n"}]}], ")"}]}], "-", 
                  RowBox[{"2", " ", "n", " ", 
                   RowBox[{"Cosh", "[", 
                    RowBox[{"2", " ", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "+", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]}], ")"}]}]}], 
                    ")"}], " ", 
                    RowBox[{"Csch", "[", "\[Eta]", "]"}], " ", 
                    RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                    RowBox[{
                    "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", 
                    "m", ",", "\[Lambda]"}], "]"}]}], 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
                    RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}]}]], "+", 
                  RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]"}]], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox["1", "2"], "-", "m", "+", "n"}], ")"}], " ", 
                   RowBox[{"Csch", "[", "\[Eta]", "]"}], " ", 
                   RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                    RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
                    RowBox[{"1", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
                    "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]]}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", "m"}], "-", 
                  RowBox[{"2", " ", "n"}]}], ")"}], " ", 
                RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{"2", " ", "n"}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "n"}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{"Cosh", "[", "\[Eta]", "]"}], "2"]}]}], ")"}], 
                    " ", 
                    RowBox[{"Csch", "[", "\[Eta]", "]"}], " ", 
                    RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                    RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
                    RowBox[{"1", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
                    "]"}]}], 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
                    RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}]}]]}], "+", 
                  RowBox[{
                   SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]"}]], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox["3", "2"], "-", "m", "+", "n"}], ")"}], " ", 
                   RowBox[{"Csch", "[", "\[Eta]", "]"}], " ", 
                   RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
                    RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
                    RowBox[{"2", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
                    "]"}]}]}], ")"}]}]}], ")"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], ")"}]}], 
        RowBox[{"4", " ", "\[FormalA]"}]]},
      {
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "3"}], " ", "\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
         "m", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]}], ")"}], " ", 
         RowBox[{"Csch", "[", "\[Eta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]}], ")"}], " ", 
            RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
             RowBox[{
             "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", 
              ",", "\[Lambda]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Theta]"}]]}], ")"}],
             " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "m"}], "-", 
              RowBox[{"2", " ", "n"}]}], ")"}], " ", 
            RowBox[{"\[CapitalPsi]\[CapitalPsi]", "[", 
             RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", 
              RowBox[{"1", "+", "n"}], ",", "m", ",", "\[Lambda]"}], 
             "]"}]}]}], ")"}]}], 
        RowBox[{"8", " ", "\[FormalA]"}]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.761070804132128*^9, {3.7610708404487453`*^9, 3.7610708480690775`*^9}, {
   3.76107149992687*^9, 3.7610715071468554`*^9}, 3.761071541566392*^9, 
   3.761119627409377*^9, 3.761160815822409*^9, 3.7612120190789113`*^9, 
   3.761214077392189*^9, 3.761287041146616*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"AngMomScalNorm", "[", 
      RowBox[{"f", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
     ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], 
   "/", 
   RowBox[{"(", 
    RowBox[{"-", "I"}], ")"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7612170007785344`*^9, 3.7612170428814116`*^9}, {
  3.76124483492178*^9, 3.7612448355214357`*^9}, {3.7612449203008747`*^9, 
  3.7612449247173305`*^9}, {3.761245007737765*^9, 3.761245040504004*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Coth", "[", "\[Eta]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
        RowBox[{
         SuperscriptBox["f", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{
         SuperscriptBox["f", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["f", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
           RowBox[{
            SuperscriptBox["f", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"1", ",", "0", ",", "0"}], ")"}],
              Derivative],
             MultilineFunction->None], "[", 
            RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
         ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.761217033447837*^9, 3.761217043389121*^9}, 
   3.7612448363749447`*^9, 3.7612449252910028`*^9, {3.761245019742886*^9, 
   3.761245031946891*^9}, 3.761287041445958*^9}]
}, Open  ]],

Cell[BoxData["\[AliasDelimiter]"], "Input",
 CellChangeTimes->{3.7612274916155243`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Sanity", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Div", "[", 
      RowBox[{
       RowBox[{"AngMomScalNorm", "[", 
        RowBox[{"f", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", " ", 
       "\"\<Toroidal\>\""}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Div", "[", 
      RowBox[{
       RowBox[{"L\[CapitalPsi]\[CapitalPsi]Norm", "[", 
        RowBox[{
        "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
         "\[Lambda]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", " ", 
       "\"\<Toroidal\>\""}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7610505524707155`*^9, 3.7610506167732544`*^9}, {
  3.761050755242183*^9, 3.7610507773996725`*^9}, {3.7610709076871977`*^9, 
  3.7610709134185543`*^9}, {3.7610710059780717`*^9, 3.761071042325322*^9}, {
  3.761119755607922*^9, 3.761119842717737*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.761119856773684*^9, 3.761160840894043*^9, 
  3.761212047094859*^9, 3.7612141024818125`*^9, 3.761287042248124*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.761119856773684*^9, 3.761160840894043*^9, 
  3.761212047094859*^9, 3.7612141024818125`*^9, 3.761287048432624*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"L", 
     RowBox[{"(", "x", ")"}]}], "=", 
    RowBox[{
     RowBox[{"-", "I"}], 
     RowBox[{"(", 
      RowBox[{"0", ",", "z", ",", 
       RowBox[{"-", "y"}]}], ")"}], " ", "in", " ", "cartesian", " ", 
     "coordinates"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LxToro", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"AngMomScal", "[", 
        RowBox[{"X", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
       ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToroToCart", "[", 
       RowBox[{"LxToro", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], 
       "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "I"}], 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Z", "[", 
           RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Y", "[", 
            RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
         "}"}]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"L", 
      RowBox[{"(", "y", ")"}]}], "=", 
     RowBox[{
      RowBox[{"-", "I"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "z"}], ",", "0", ",", "x"}], ")"}], " ", "in", " ", 
      "cartesian", " ", "coordinates"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LyToro", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"AngMomScal", "[", 
        RowBox[{"Y", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
       ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToroToCart", "[", 
       RowBox[{"LyToro", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], 
       "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "I"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Z", "[", 
            RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], ",", 
          "0", ",", 
          RowBox[{"X", "[", 
           RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], 
         "}"}]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"L", 
      RowBox[{"(", "z", ")"}]}], "=", 
     RowBox[{
      RowBox[{"-", "I"}], 
      RowBox[{"(", 
       RowBox[{"y", ",", 
        RowBox[{"-", "x"}], ",", "0"}], ")"}], " ", "in", " ", "cartesian", 
      " ", "coordinates"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LzToro", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"AngMomScal", "[", 
        RowBox[{"Z", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
       ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToroToCart", "[", 
       RowBox[{"LzToro", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], 
       "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "I"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"X", "[", 
            RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], ",", 
          "0"}], "}"}]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"**", "**"}], "**"}], "**"}], "*******)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"curl", " ", 
      RowBox[{"(", 
       RowBox[{"L", 
        RowBox[{"(", "x", ")"}]}], ")"}]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"I2", ",", "0", ",", "0"}], ")"}], " ", "in", " ", "cartesian",
       " ", "coordinates"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curlLxToroNorm", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Curl", "[", 
        RowBox[{
         RowBox[{"AngMomScalNorm", "[", 
          RowBox[{"X", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}],
          ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
         " ", "\"\<Toroidal\>\""}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
          RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curlLxToro", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"curlLxToroNorm", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/", 
        SqrtBox[
         RowBox[{"gMet", "[", 
          RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "i"}], 
          "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToroToCart", "[", 
       RowBox[{"curlLxToro", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], 
       "]"}], "-", 
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"I", "*", "2"}], ",", "0", ",", "0"}], "}"}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"curl", " ", 
      RowBox[{"(", 
       RowBox[{"L", 
        RowBox[{"(", "y", ")"}]}], ")"}]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0", ",", " ", "I2", ",", "0"}], ")"}], " ", "in", " ", 
      "cartesian", " ", "coordinates"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curlLyToroNorm", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Curl", "[", 
        RowBox[{
         RowBox[{"AngMomScalNorm", "[", 
          RowBox[{"Y", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}],
          ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
         " ", "\"\<Toroidal\>\""}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
          RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curlLyToro", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"curlLyToroNorm", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/", 
        SqrtBox[
         RowBox[{"gMet", "[", 
          RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "i"}], 
          "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToroToCart", "[", 
       RowBox[{"curlLyToro", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], 
       "]"}], "-", 
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"I", "*", "2"}], ",", "0"}], "}"}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"curl", " ", 
      RowBox[{"(", 
       RowBox[{"L", 
        RowBox[{"(", "z", ")"}]}], ")"}]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "I2"}], ")"}], " ", "in", " ", "cartesian",
       " ", "coordinates"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curlLzToroNorm", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Curl", "[", 
        RowBox[{
         RowBox[{"AngMomScalNorm", "[", 
          RowBox[{"Z", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}],
          ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
         " ", "\"\<Toroidal\>\""}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
          RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
          RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curlLzToro", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"curlLzToroNorm", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/", 
        SqrtBox[
         RowBox[{"gMet", "[", 
          RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "i"}], 
          "]"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToroToCart", "[", 
       RowBox[{"curlLzToro", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], 
       "]"}], "-", 
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"I", "*", "2"}]}], "}"}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7611198812366705`*^9, 3.761119932486307*^9}, {
   3.7611199790256605`*^9, 3.7611200892105303`*^9}, {3.7611203250084085`*^9, 
   3.761120427659594*^9}, {3.761160875601159*^9, 3.761160991559719*^9}, {
   3.7611611720119348`*^9, 3.761161336695597*^9}, {3.761161384264324*^9, 
   3.761161483822279*^9}, {3.7611615155570965`*^9, 3.761161517679885*^9}, 
   3.761161549010929*^9, {3.761161649764203*^9, 3.7611617808980675`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7611198691156125`*^9, 3.7611199205591583`*^9, {3.7611203336234765`*^9, 
   3.7611203674571047`*^9}, {3.7611204050745363`*^9, 3.7611204305239506`*^9}, 
   3.7611608555936236`*^9, {3.7611609251737547`*^9, 3.7611609367890997`*^9}, 
   3.7611609921853757`*^9, {3.7611613179992914`*^9, 3.7611613375900793`*^9}, {
   3.761161468053316*^9, 3.7611615191380463`*^9}, 3.761161550314183*^9, 
   3.761161664071007*^9, 3.761161708950334*^9, {3.7611617620009103`*^9, 
   3.761161781950465*^9}, 3.7612120698278356`*^9, 3.761214114156125*^9, 
   3.761287048579486*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7611198691156125`*^9, 3.7611199205591583`*^9, {3.7611203336234765`*^9, 
   3.7611203674571047`*^9}, {3.7611204050745363`*^9, 3.7611204305239506`*^9}, 
   3.7611608555936236`*^9, {3.7611609251737547`*^9, 3.7611609367890997`*^9}, 
   3.7611609921853757`*^9, {3.7611613179992914`*^9, 3.7611613375900793`*^9}, {
   3.761161468053316*^9, 3.7611615191380463`*^9}, 3.761161550314183*^9, 
   3.761161664071007*^9, 3.761161708950334*^9, {3.7611617620009103`*^9, 
   3.761161781950465*^9}, 3.7612120698278356`*^9, 3.761214114156125*^9, 
   3.7612870485950756`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7611198691156125`*^9, 3.7611199205591583`*^9, {3.7611203336234765`*^9, 
   3.7611203674571047`*^9}, {3.7611204050745363`*^9, 3.7611204305239506`*^9}, 
   3.7611608555936236`*^9, {3.7611609251737547`*^9, 3.7611609367890997`*^9}, 
   3.7611609921853757`*^9, {3.7611613179992914`*^9, 3.7611613375900793`*^9}, {
   3.761161468053316*^9, 3.7611615191380463`*^9}, 3.761161550314183*^9, 
   3.761161664071007*^9, 3.761161708950334*^9, {3.7611617620009103`*^9, 
   3.761161781950465*^9}, 3.7612120698278356`*^9, 3.761214114156125*^9, 
   3.7612870485950756`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7611198691156125`*^9, 3.7611199205591583`*^9, {3.7611203336234765`*^9, 
   3.7611203674571047`*^9}, {3.7611204050745363`*^9, 3.7611204305239506`*^9}, 
   3.7611608555936236`*^9, {3.7611609251737547`*^9, 3.7611609367890997`*^9}, 
   3.7611609921853757`*^9, {3.7611613179992914`*^9, 3.7611613375900793`*^9}, {
   3.761161468053316*^9, 3.7611615191380463`*^9}, 3.761161550314183*^9, 
   3.761161664071007*^9, 3.761161708950334*^9, {3.7611617620009103`*^9, 
   3.761161781950465*^9}, 3.7612120698278356`*^9, 3.761214114156125*^9, 
   3.7612870507317452`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7611198691156125`*^9, 3.7611199205591583`*^9, {3.7611203336234765`*^9, 
   3.7611203674571047`*^9}, {3.7611204050745363`*^9, 3.7611204305239506`*^9}, 
   3.7611608555936236`*^9, {3.7611609251737547`*^9, 3.7611609367890997`*^9}, 
   3.7611609921853757`*^9, {3.7611613179992914`*^9, 3.7611613375900793`*^9}, {
   3.761161468053316*^9, 3.7611615191380463`*^9}, 3.761161550314183*^9, 
   3.761161664071007*^9, 3.761161708950334*^9, {3.7611617620009103`*^9, 
   3.761161781950465*^9}, 3.7612120698278356`*^9, 3.761214114156125*^9, 
   3.761287052357538*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7611198691156125`*^9, 3.7611199205591583`*^9, {3.7611203336234765`*^9, 
   3.7611203674571047`*^9}, {3.7611204050745363`*^9, 3.7611204305239506`*^9}, 
   3.7611608555936236`*^9, {3.7611609251737547`*^9, 3.7611609367890997`*^9}, 
   3.7611609921853757`*^9, {3.7611613179992914`*^9, 3.7611613375900793`*^9}, {
   3.761161468053316*^9, 3.7611615191380463`*^9}, 3.761161550314183*^9, 
   3.761161664071007*^9, 3.761161708950334*^9, {3.7611617620009103`*^9, 
   3.761161781950465*^9}, 3.7612120698278356`*^9, 3.761214114156125*^9, 
   3.761287052532301*^9}]
}, Open  ]],

Cell[BoxData[Cell[TextData[StyleBox["Test the r.\[Del]\[Cross]L\[CapitalPsi] \
term",
  FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
  CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
   3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
   3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
   3.7608599456415024`*^9, 3.760859989231761*^9}, {3.7608664456516542`*^9, 
   3.7608664545389132`*^9}, {3.76104140517836*^9, 
   3.761041413417799*^9}}]], "Input",
 CellChangeTimes->{{3.7610414509025135`*^9, 3.761041457654853*^9}, 
   3.761041497643795*^9, {3.761043551546646*^9, 3.7610435728156757`*^9}, {
   3.7610710714895697`*^9, 3.7610711156853657`*^9}, {3.761071377422288*^9, 
   3.7610713955877466`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Analytical", ",", " ", 
    RowBox[{
     RowBox[{
     "will", " ", "keep", " ", "all", " ", "the", " ", "derivatives", " ", 
      "un"}], "-", 
     RowBox[{
     "evaluated", " ", "it", " ", "gets", " ", "crazy", " ", 
      "otherwise"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"curlL\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]Norm", "[", 
     RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Curl", "[", 
     RowBox[{
      RowBox[{"AngMomScalNorm", "[", 
       RowBox[{
       "\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", ",", "\[Eta]", ",", 
        "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", " ", 
      "\"\<Toroidal\>\""}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rDotCurlL\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", "[", 
     RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"rVecNorm", "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ".", 
     RowBox[{"curlL\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]Norm", "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"rDotCurlL\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.761071119345193*^9, 3.7610712758675165`*^9}, {
   3.7610716135961328`*^9, 3.761071634525326*^9}, {3.761071676143605*^9, 
   3.761071715983942*^9}, {3.7610719641853437`*^9, 3.7610719647493596`*^9}, {
   3.761072064310125*^9, 3.761072280561172*^9}, {3.7610723561727405`*^9, 
   3.7610723861382804`*^9}, 3.7610725369198713`*^9, {3.7611618509599257`*^9, 
   3.761161889885623*^9}, {3.7611632226315403`*^9, 3.761163320129677*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
  SuperscriptBox[
   RowBox[{"Sinh", "[", "\[Eta]", "]"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}], "-", 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", " ", "\[Eta]"}], "]"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Csch", "[", "\[Eta]", "]"}], "4"], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"Coth", "[", "\[Eta]", "]"}], "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "-", 
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Csch", "[", "\[Eta]", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Csch", "[", "\[Eta]", "]"}], "4"], " ", 
        RowBox[{"Sinh", "[", 
         RowBox[{"4", " ", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{"8", " ", 
     RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{
         SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.76107196122313*^9, 3.7610719865122194`*^9}, {
   3.7610722742429676`*^9, 3.761072297728151*^9}, 3.7610724079695463`*^9, 
   3.76107255396496*^9, 3.7611619380380344`*^9, {3.7611632608826237`*^9, 
   3.761163303151402*^9}, {3.7611633361524935`*^9, 3.761163336477309*^9}, 
   3.761214148444477*^9, 3.761287075765633*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"look", " ", "at", " ", "Cartesian", " ", "case"}], "*)"}]], "Input",
 CellChangeTimes->{{3.761212241936239*^9, 3.7612122507871537`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rCurlLfCart", "[", 
   RowBox[{"f_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], ".", 
      RowBox[{"Curl", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "I"}], ")"}], 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xx", ",", "yy", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"xx", ",", "yy", ",", "zz"}], "]"}], ",", "xx"}], 
              "]"}], ",", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"xx", ",", "yy", ",", "zz"}], "]"}], ",", "yy"}], 
              "]"}], ",", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"xx", ",", "yy", ",", "zz"}], "]"}], ",", "zz"}], 
              "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"xx", ",", "yy", ",", "zz"}], "}"}]}], "]"}]}], "/.", 
     RowBox[{"xx", "\[Rule]", "x"}]}], "/.", 
    RowBox[{"yy", "\[Rule]", "y"}]}], "/.", 
   RowBox[{"zz", "\[Rule]", "z"}]}]}]], "Input",
 CellChangeTimes->{{3.7612122555174446`*^9, 3.7612124250313196`*^9}, {
  3.7612127545805206`*^9, 3.76121276181437*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"rCurlLfCart", "[", 
   RowBox[{"f", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7612127017857695`*^9, 3.761212725185363*^9}, {
  3.7612127749338408`*^9, 3.761212777180572*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "z", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", "y", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", "y", " ", "z", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", "x", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", "x", " ", "z", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", "x", " ", "y", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["y", "2"], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.761212697059471*^9, 3.7612127037306366`*^9}, 
   3.761212790088176*^9, 3.761214148696334*^9, 3.7612870759036436`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Define", " ", "toroidal", " ", "case"}], "*)"}]], "Input",
 CellChangeTimes->{{3.761212679317624*^9, 3.7612126854231443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rCurlLfToro", "[", 
   RowBox[{"h_", ",", "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"rVecNorm", "[", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ".", 
      RowBox[{"Curl", "[", 
       RowBox[{
        RowBox[{"AngMomScalNorm", "[", 
         RowBox[{
         "h", ",", "\[CapitalEta]", ",", "\[CapitalTheta]", ",", 
          "\[CapitalPhi]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
         "}"}], ",", " ", "\"\<Toroidal\>\""}], "]"}]}], "/.", 
     RowBox[{"\[CapitalEta]", "\[Rule]", "\[Eta]"}]}], "/.", 
    RowBox[{"\[CapitalTheta]", "\[Rule]", "\[Theta]"}]}], "/.", 
   RowBox[{"\[CapitalPhi]", "\[Rule]", "\[Phi]"}]}]}]], "Input",
 CellChangeTimes->{{3.761212491268367*^9, 3.761212671051375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"rCurlLfToro", "[", 
    RowBox[{
    "\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", ",", "\[Eta]", ",", "\[Theta]",
      ",", "\[Phi]"}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7612128150478563`*^9, 3.761212856827918*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
  SuperscriptBox[
   RowBox[{"Sinh", "[", "\[Eta]", "]"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}], "-", 
       RowBox[{"Cosh", "[", 
        RowBox[{"2", " ", "\[Eta]"}], "]"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Csch", "[", "\[Eta]", "]"}], "4"], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"Coth", "[", "\[Eta]", "]"}], "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "-", 
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Csch", "[", "\[Eta]", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Csch", "[", "\[Eta]", "]"}], "4"], " ", 
        RowBox[{"Sinh", "[", 
         RowBox[{"4", " ", "\[Eta]"}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
    RowBox[{"8", " ", 
     RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
        RowBox[{
         SuperscriptBox["\[CapitalPsi]\[CapitalPsi]\[CapitalPsi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.761212835753996*^9, 3.761212884045322*^9, 
  3.761214162899195*^9, 3.7612462349405947`*^9, 3.7612870788417788`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Now", " ", "compare", " ", "them"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7612129002630506`*^9, 3.7612129059447956`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cartCase", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"rCurlLfCart", "[", 
    RowBox[{"f", ",", "x", ",", "y", ",", "z"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.76121306631589*^9, 3.761213081893964*^9}, 
   3.7612131367645454`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "\[ImaginaryI]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "z", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", "y", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", "y", " ", "z", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", "x", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", "x", " ", "z", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "-", 
    RowBox[{"2", " ", "x", " ", "y", " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["y", "2"], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["z", "2"], " ", 
     RowBox[{
      SuperscriptBox["f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.761212919785844*^9, 3.761213137544091*^9, 
  3.7612141630361376`*^9, 3.761287078888648*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{"\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"f", "[", 
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
    RowBox[{"Y", "[", 
     RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
    RowBox[{"Z", "[", 
     RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"toroCase", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"rCurlLfToro", "[", 
     RowBox[{"F", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.761212933012267*^9, 3.761212978870993*^9}, {
  3.7612130980657005`*^9, 3.761213133803224*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
       RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], "2"]}]], 
  RowBox[{"\[ImaginaryI]", " ", "\[FormalA]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
        RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{
       SuperscriptBox["f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        FractionBox[
         RowBox[{"\[FormalA]", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
        FractionBox[
         RowBox[{"\[FormalA]", " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
        FractionBox[
         RowBox[{"\[FormalA]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}]}], "-", 
     RowBox[{"2", " ", "\[FormalA]", " ", 
      SuperscriptBox[
       RowBox[{"Sinh", "[", "\[Eta]", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "2"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        FractionBox[
         RowBox[{"\[FormalA]", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
        FractionBox[
         RowBox[{"\[FormalA]", " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
        FractionBox[
         RowBox[{"\[FormalA]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}]}], "+", 
     RowBox[{"4", " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sinh", "[", "\[Eta]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["f", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}]}], "+", 
        RowBox[{"\[FormalA]", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{
          SuperscriptBox["f", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}]}]}], ")"}]}], 
     "+", 
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sinh", "[", "\[Eta]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
           RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["f", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}]}], "+", 
        RowBox[{"\[FormalA]", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{
          SuperscriptBox["f", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}]}]}], ")"}]}], 
     "+", 
     RowBox[{"2", " ", "\[FormalA]", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sinh", "[", "\[Eta]", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{
        FractionBox[
         RowBox[{"\[FormalA]", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
        FractionBox[
         RowBox[{"\[FormalA]", " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
        FractionBox[
         RowBox[{"\[FormalA]", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}]}], "+", 
     RowBox[{"\[FormalA]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Phi]"}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sinh", "[", "\[Eta]", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["f", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
             RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
           FractionBox[
            RowBox[{"\[FormalA]", " ", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
             RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["f", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"\[FormalA]", " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
          FractionBox[
           RowBox[{"\[FormalA]", " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
          FractionBox[
           RowBox[{"\[FormalA]", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}]}], ")"}]}], "+", 
     RowBox[{"\[FormalA]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}], "-", 
        SuperscriptBox[
         RowBox[{"Cosh", "[", "\[Eta]", "]"}], "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["f", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"\[FormalA]", " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
          FractionBox[
           RowBox[{"\[FormalA]", " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
          FractionBox[
           RowBox[{"\[FormalA]", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}], "+", 
        RowBox[{
         SuperscriptBox["f", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"\[FormalA]", " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
          FractionBox[
           RowBox[{"\[FormalA]", " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
            RowBox[{"Sinh", "[", "\[Eta]", "]"}]}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]], ",", 
          FractionBox[
           RowBox[{"\[FormalA]", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Cosh", "[", "\[Eta]", "]"}]}]]}], "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.7612132154174623`*^9, 3.7612142622302823`*^9, 
  3.761287137175453*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "test", " ", "if", " ", "the", " ", "two", " ", "expressions", " ", 
    "equations", " ", "agree"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"toroCase", "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"cartCase", "/.", 
         RowBox[{"x", "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], "/.", 
        RowBox[{"y", "\[Rule]", 
         RowBox[{"Y", "[", 
          RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], "/.", 
       RowBox[{"z", "\[Rule]", 
        RowBox[{"Z", "[", 
         RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
      ")"}]}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
       RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7612132552436438`*^9, 3.7612133461015835`*^9}, {
  3.761213447678602*^9, 3.761213447923462*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.7612132920915484`*^9, {3.76121343970059*^9, 3.761213448654053*^9}, 
   3.761214262418196*^9, 3.7612871373602*^9}]
}, Open  ]],

Cell[BoxData[Cell[TextData[StyleBox["CSV Test the r.\[Del]\[Cross]L\
\[CapitalPsi] term",
  FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
  CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
   3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
   3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
   3.7608599456415024`*^9, 3.760859989231761*^9}, {3.7608664456516542`*^9, 
   3.7608664545389132`*^9}, {3.76104140517836*^9, 
   3.761041413417799*^9}}]], "Input",
 CellChangeTimes->{{3.7610414509025135`*^9, 3.761041457654853*^9}, 
   3.761041497643795*^9, {3.761043551546646*^9, 3.7610435728156757`*^9}, {
   3.7610710714895697`*^9, 3.7610711156853657`*^9}, {3.761071377422288*^9, 
   3.7610713955877466`*^9}, {3.761248931356805*^9, 3.761248935456448*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rCurlL\[CapitalPsi]", "[", 
    RowBox[{
    "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", "n_", ",", "m_", ",", 
     "\[Lambda]_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"rCurlLfToro", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]"}], 
          "}"}], ",", 
         RowBox[{"\[CapitalPsi]", "[", 
          RowBox[{
          "\[CapitalEta]", ",", "\[CapitalTheta]", ",", "\[CapitalPhi]", ",", 
           "n", ",", "m", ",", "\[Lambda]"}], "]"}]}], "]"}], ",", "\[Eta]", 
       ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.761249009885825*^9, 3.7612490209354935`*^9}, {
  3.761249073195533*^9, 3.7612491585386343`*^9}, {3.7612492315737886`*^9, 
  3.7612493562873316`*^9}, {3.761249447284219*^9, 3.7612494658335896`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"rCurlL\[CapitalPsi]", "[", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "1"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7612491714492373`*^9, 3.761249176663268*^9}, {
  3.76124942149399*^9, 3.761249433786971*^9}}],

Cell[BoxData[
 RowBox[{"755.2837422322315`", "\[VeryThinSpace]", "+", 
  RowBox[{"273.24793560624863`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.7612491783802643`*^9, 3.7612492852400384`*^9, 
  3.761249363156415*^9, 3.7612494355619326`*^9, 3.7612494704809456`*^9, 
  3.7612871390641828`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tryCount", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "numData", "]"}], ";", 
   RowBox[{"numData", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "tryCount"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"5", "+", 
         RowBox[{"2", "*", "2"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iTry", "=", "1"}], ",", 
    RowBox[{"iTry", "<=", "tryCount"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rand\[Eta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0.001", ",", " ", "10"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Theta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Phi]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "*", "\[Pi]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"randn", " ", "=", " ", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "30"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"randm", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "30"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"basic", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rCurlL\[CapitalPsi]First", "=", 
      RowBox[{"rCurlL\[CapitalPsi]", "[", 
       RowBox[{
       "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "randn", 
        ",", "randm", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rCurlL\[CapitalPsi]Second", "=", 
      RowBox[{"rCurlL\[CapitalPsi]", "[", 
       RowBox[{
       "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "randn", 
        ",", "randm", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"save", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "rand\[Eta]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", "rand\[Theta]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", "rand\[Phi]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", "randn"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}], "=", "randm"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iOffset", " ", "=", " ", "5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"now", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "rCurlL\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "2"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "rCurlL\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "3"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "rCurlL\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "4"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "rCurlL\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iTry", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<C:\\\\Users\\\\Vassili\\\\Dropbox\\\\DARPA_Work\\\\TORH_GIT\\\\\
ToroidalHarmonics\\\\ToroidalHarmonicsDefinition_Convention\\\\contrTens_\
rCurlL_psi.csv\>\"", ",", "numData", ",", "\"\<CSV\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.760866393884334*^9, 3.7608663952761917`*^9}, {
   3.7608664764699373`*^9, 3.760866476794617*^9}, {3.760866731274129*^9, 
   3.760866829554427*^9}, {3.760866906000129*^9, 3.7608669145198784`*^9}, {
   3.760867501156725*^9, 3.76086751089869*^9}, {3.761248963687278*^9, 
   3.7612489638261943`*^9}, {3.7612495036779084`*^9, 3.7612495787918887`*^9}, 
   3.7612505089121504`*^9, 3.761250623394552*^9}],

Cell[BoxData[Cell[TextData[StyleBox["Deal with L.L term",
  FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
  CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
   3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
   3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
   3.7608599456415024`*^9, 3.760859989231761*^9}, {3.7608664456516542`*^9, 
   3.7608664545389132`*^9}, {3.76104140517836*^9, 
   3.761041413417799*^9}}]], "Input",
 CellChangeTimes->{{3.7610414509025135`*^9, 3.761041457654853*^9}, 
   3.761041497643795*^9, {3.761043551546646*^9, 3.7610435728156757`*^9}, {
   3.7610710714895697`*^9, 3.7610711156853657`*^9}, {3.761071377422288*^9, 
   3.7610713955877466`*^9}, {3.761248931356805*^9, 3.761248935456448*^9}, {
   3.7612519754044933`*^9, 3.7612520250536933`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
    "We", " ", "define", " ", "the", " ", "L2", " ", "term", " ", "as", " ", 
     SuperscriptBox["L", "2"], "\[CapitalPsi]"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["g", "\[Alpha]\[Mu]"], " ", 
      SuperscriptBox["L", "\[Alpha]"], 
      SuperscriptBox["L", "\[Mu]"], "\[CapitalPsi]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["ig", "\[Alpha]\[Mu]"]}], 
       FractionBox[
        SuperscriptBox["\[Epsilon]", "\[Alpha]\[Beta]\[Gamma]"], 
        SqrtBox["g"]], 
       SubscriptBox["r", "\[Beta]"], 
       RowBox[{
        SubscriptBox["\[Del]", "\[Gamma]"], 
        SuperscriptBox["L", "\[Mu]"]}], "\[CapitalPsi]"}], "=", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["ig", "\[Alpha]\[Alpha]"]}], 
       FractionBox[
        SuperscriptBox["\[Epsilon]", "\[Alpha]\[Beta]\[Gamma]"], 
        SqrtBox["g"]], 
       SubscriptBox["r", "\[Beta]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Gamma]"], 
           SuperscriptBox["L", "\[Alpha]"]}], "\[CapitalPsi]"}], "+", 
         RowBox[{
          SubscriptBox[
           RowBox[{"(", 
            SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], ")"}], 
           "\[Gamma]\[Kappa]"], 
          SuperscriptBox["L", "\[Kappa]"], "\[CapitalPsi]"}]}], ")"}]}]}]}]}],
    ",", " ", 
   RowBox[{
    RowBox[{
    "note", " ", "that", " ", "this", " ", "is", " ", "the", " ", "non"}], 
    "-", 
    RowBox[{"normalized", " ", "angular", " ", "momentum"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7612520282768517`*^9, 3.7612520406947365`*^9}, {
  3.7612524002317176`*^9, 3.761252643699301*^9}, {3.761252731963052*^9, 
  3.761252865162426*^9}, {3.761252929900507*^9, 3.761252946072403*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"L2Toro", "[", 
    RowBox[{"f_", ",", "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "I"}], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"gMet", "[", 
              RowBox[{
              "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "\[Alpha]"}], 
              "]"}], 
             RowBox[{"jacobian", "[", 
              RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]], 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "[", 
               RowBox[{"[", "\[Alpha]", "]"}], "]"}], "[", 
              RowBox[{"[", "\[Beta]", "]"}], "]"}], "[", 
             RowBox[{"[", "\[Gamma]", "]"}], "]"}], 
            RowBox[{
             RowBox[{"rCoVec", "[", 
              RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "[", 
             RowBox[{"[", "\[Beta]", "]"}], "]"}], "*", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"AngMomScal", "[", 
                  RowBox[{
                  "f", ",", "\[CapitalEta]", ",", "\[CapitalTheta]", ",", 
                   "\[CapitalPhi]"}], "]"}], "[", 
                 RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\[CapitalEta]", ",", "\[CapitalTheta]", ",", 
                   "\[CapitalPhi]"}], "}"}], "[", 
                 RowBox[{"[", "\[Gamma]", "]"}], "]"}]}], "]"}], "+", 
              "\[IndentingNewLine]", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{
                  "\[CapitalEta]", ",", "\[CapitalTheta]", ",", 
                   "\[CapitalPhi]", ",", "\[Alpha]", ",", "\[Gamma]", ",", 
                   "\[Kappa]"}], "]"}], 
                 RowBox[{
                  RowBox[{"AngMomScal", "[", 
                   RowBox[{
                   "f", ",", "\[CapitalEta]", ",", "\[CapitalTheta]", ",", 
                    "\[CapitalPhi]"}], "]"}], "[", 
                  RowBox[{"[", "\[Kappa]", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Kappa]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
             ")"}]}], "/.", 
           RowBox[{"\[CapitalEta]", "\[Rule]", "\[Eta]"}]}], "/.", 
          RowBox[{"\[CapitalTheta]", "\[Rule]", "\[Theta]"}]}], "/.", 
         RowBox[{"\[CapitalPhi]", "\[Rule]", "\[Phi]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Beta]", ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
        RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.761252870347455*^9, 3.7612529185740023`*^9}, {
  3.761252957732724*^9, 3.7612534229235754`*^9}, {3.7612534908796635`*^9, 
  3.7612534924357758`*^9}, {3.761253680125085*^9, 3.761253682040987*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"L2Toro", "[", 
    RowBox[{"f", ",", "\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Eta]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Eta]", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Phi]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[FormalA]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[FormalA]", "\[GreaterEqual]", "0"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.761253427062206*^9, 3.7612534404265738`*^9}, {
  3.761253707853217*^9, 3.7612537209327044`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Coth", "[", "\[Eta]", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ")"}]}], " ", 
   RowBox[{
    SuperscriptBox["f", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "2"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sinh", "[", "\[Eta]", "]"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["f", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "2", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cosh", "[", "\[Eta]", "]"}]}], " ", 
         RowBox[{"Coth", "[", "\[Eta]", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
         RowBox[{"Sinh", "[", "\[Eta]", "]"}]}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
      RowBox[{"Sinh", "[", "\[Eta]", "]"}], " ", 
      RowBox[{
       SuperscriptBox["f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cosh", "[", "\[Eta]", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"2", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"\[Eta]", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7612534431010385`*^9, 3.7612535382273855`*^9, {3.761253665337577*^9, 
   3.76125368852627*^9}, 3.7612537400947437`*^9, 3.7612871486518865`*^9}]
}, Open  ]],

Cell[BoxData[Cell[TextData[StyleBox["Test the full inversion r\[CapitalPsi] \
term",
  FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
  CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
   3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
   3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
   3.7608599456415024`*^9, 3.760859989231761*^9}, {3.7608664456516542`*^9, 
   3.7608664545389132`*^9}, {3.76104140517836*^9, 
   3.761041413417799*^9}}]], "Input",
 CellChangeTimes->{{3.7610414509025135`*^9, 3.761041457654853*^9}, 
   3.761041497643795*^9, {3.761043551546646*^9, 3.7610435728156757`*^9}, {
   3.7610710714895697`*^9, 3.7610711156853657`*^9}, {3.761071377422288*^9, 
   3.7610713955877466`*^9}, {3.761248931356805*^9, 3.761248935456448*^9}, {
   3.7612519754044933`*^9, 3.7612520250536933`*^9}, {3.7612873443064947`*^9, 
   3.761287383132529*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "we", " ", "will", " ", "get", " ", "contributions", " ", "in", " ", "the", 
   " ", 
   RowBox[{"r", ".", "F"}], " ", "and", " ", "div", 
   RowBox[{"(", "F", ")"}], " ", "terms"}], "*)"}]], "Input",
 CellChangeTimes->{{3.761295811177617*^9, 3.7612958306349473`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptCount", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceN", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "6"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceM", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "6"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "numData", "]"}], ";", 
   RowBox[{"numData", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ptCount"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"5", "+", 
         RowBox[{"2", "*", "2"}], "+", 
         RowBox[{"2", "*", "2"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iTry", "=", "1"}], ",", 
    RowBox[{"iTry", "\[LessEqual]", "ptCount"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rand\[Eta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "2"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Theta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Phi]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "*", "\[Pi]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"div", ".", "F"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"divr\[CapitalPsi]First", "=", 
      RowBox[{"divr\[CapitalPsi]", "[", 
       RowBox[{
       "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "choiceN", 
        ",", "choiceM", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"divr\[CapitalPsi]Second", "=", 
      RowBox[{"divr\[CapitalPsi]", "[", 
       RowBox[{
       "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "choiceN", 
        ",", "choiceM", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"r", ".", "F"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r2\[CapitalPsi]First", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"rSq", "[", 
         RowBox[{"rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]"}], 
         "]"}], "*", 
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{
         "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "choiceN",
           ",", "choiceM", ",", "1"}], "]"}]}], "/.", 
       RowBox[{"\[FormalA]", "\[Rule]", "1"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r2\[CapitalPsi]Second", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"rSq", "[", 
         RowBox[{"rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]"}], 
         "]"}], "*", 
        RowBox[{"\[CapitalPsi]", "[", 
         RowBox[{
         "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "choiceN",
           ",", "choiceM", ",", "2"}], "]"}]}], "/.", 
       RowBox[{"\[FormalA]", "\[Rule]", "1"}]}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"save", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "rand\[Eta]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", "rand\[Theta]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", "rand\[Phi]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", "choiceN"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}], "=", "choiceM"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iOffset", " ", "=", " ", "5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"now", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "divr\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "2"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "divr\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "3"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "divr\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "4"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "divr\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iOffset", " ", "=", " ", 
      RowBox[{"5", "+", "4"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"now", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "r2\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "2"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "r2\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "3"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "r2\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "4"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "r2\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iTry", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<C:\\\\Users\\\\Vassili Savinov\\\\Dropbox\\\\DARPA_Work\\\\TORH_GIT\\\
\\ToroidalHarmonics\\\\ToroidalHarmonicsDefinition_Convention\\\\rPsi_term_v5.\
csv\>\"", ",", "numData", ",", "\"\<CSV\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.760866393884334*^9, 3.7608663952761917`*^9}, {
   3.7608664764699373`*^9, 3.760866476794617*^9}, {3.760866731274129*^9, 
   3.760866829554427*^9}, {3.760866906000129*^9, 3.7608669145198784`*^9}, {
   3.760867501156725*^9, 3.76086751089869*^9}, {3.761248963687278*^9, 
   3.7612489638261943`*^9}, {3.7612495036779084`*^9, 3.7612495787918887`*^9}, 
   3.7612505089121504`*^9, 3.761250623394552*^9, {3.761287394117325*^9, 
   3.7612873942332726`*^9}, {3.7612958399159007`*^9, 
   3.7612960622771454`*^9}, {3.761296481874473*^9, 3.761296490100007*^9}, {
   3.761297325208378*^9, 3.7612973884746304`*^9}, {3.761297428243307*^9, 
   3.761297439515546*^9}, {3.7612975965167017`*^9, 3.7612975988192334`*^9}, {
   3.7612987993077803`*^9, 3.7612988056928196`*^9}, {3.761298926028941*^9, 
   3.7612989904329834`*^9}, {3.761299059676083*^9, 3.761299107217651*^9}, {
   3.7612994133159685`*^9, 3.7612994262672243`*^9}, {3.761300453044572*^9, 
   3.7613004894940767`*^9}, {3.761301123381604*^9, 3.7613011267888517`*^9}, {
   3.761301368740631*^9, 3.761301370644134*^9}, {3.761301409221951*^9, 
   3.761301410739333*^9}, {3.761301659373171*^9, 3.7613016615738935`*^9}, {
   3.761302612782086*^9, 3.761302665918494*^9}, {3.7613027712055416`*^9, 
   3.761302771708708*^9}, {3.761303542667015*^9, 3.7613035431032553`*^9}, {
   3.7613036223655357`*^9, 3.7613036247187777`*^9}, {3.7613039129753723`*^9, 
   3.761303913054186*^9}, {3.7613040157014456`*^9, 3.761304023599248*^9}, {
   3.7613041258126106`*^9, 3.7613041262365065`*^9}, {3.7613051119115405`*^9, 
   3.761305112245646*^9}, {3.761305219054417*^9, 3.7613052194304123`*^9}, {
   3.761305349310015*^9, 3.7613053497498317`*^9}, {3.761305417738797*^9, 
   3.761305419054121*^9}, {3.7613056296929417`*^9, 3.761305631844621*^9}, {
   3.761305672332144*^9, 3.7613056727719393`*^9}}],

Cell[BoxData[Cell[TextData[StyleBox["Test the full inversion L\[CapitalPsi] \
term",
  FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
  CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
   3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
   3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
   3.7608599456415024`*^9, 3.760859989231761*^9}, {3.7608664456516542`*^9, 
   3.7608664545389132`*^9}, {3.76104140517836*^9, 
   3.761041413417799*^9}}]], "Input",
 CellChangeTimes->{{3.7610414509025135`*^9, 3.761041457654853*^9}, 
   3.761041497643795*^9, {3.761043551546646*^9, 3.7610435728156757`*^9}, {
   3.7610710714895697`*^9, 3.7610711156853657`*^9}, {3.761071377422288*^9, 
   3.7610713955877466`*^9}, {3.761248931356805*^9, 3.761248935456448*^9}, {
   3.7612519754044933`*^9, 3.7612520250536933`*^9}, {3.7612873443064947`*^9, 
   3.761287383132529*^9}, {3.761305723110818*^9, 3.761305724410324*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "we", " ", "will", " ", "get", " ", "contributions", " ", "in", " ", "the",
     " ", 
    RowBox[{"L", ".", "F"}], " ", 
    RowBox[{"term", ".", " ", "Note"}], " ", "that", " ", 
    SuperscriptBox["L", "2"], "\[CapitalPsi]"}], "=", 
   RowBox[{"-", 
    RowBox[{"ir", ".", "curlL\[CapitalPsi]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.761295811177617*^9, 3.7612958306349473`*^9}, {
  3.7613060347412863`*^9, 3.76130606385797*^9}, {3.761306115832*^9, 
  3.7613061227654066`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L2\[CapitalPsi]", "[", 
     RowBox[{
     "\[Eta]_", ",", "\[Theta]_", ",", "\[Phi]_", ",", " ", "n_", ",", " ", 
      "m_", ",", " ", "\[Lambda]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{"rCurlL\[CapitalPsi]", "[", 
      RowBox[{
      "\[Eta]", ",", "\[Theta]", ",", "\[Phi]", ",", "n", ",", "m", ",", 
       "\[Lambda]"}], "]"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7613058940262127`*^9, 3.7613059457043877`*^9}, {
  3.761305980578847*^9, 3.761306004274089*^9}, {3.7613061472124662`*^9, 
  3.761306159087287*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"L2\[CapitalPsi]", "[", 
   RowBox[{
   "1", ",", "2", ",", "3", ",", " ", "4", ",", " ", "5", ",", " ", "1"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.761305954751175*^9, 3.761305971894928*^9}}],

Cell[BoxData[
 RowBox[{"273.24793560624863`", "\[VeryThinSpace]", "-", 
  RowBox[{"755.2837422322315`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.761305967025053*^9, 3.7613059736630287`*^9}, 
   3.7613060224607725`*^9, 3.7613061613935995`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptCount", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceN", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "6"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceM", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "6"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "numData", "]"}], ";", 
   RowBox[{"numData", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ptCount"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"5", "+", 
         RowBox[{"2", "*", "2"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iTry", "=", "1"}], ",", 
    RowBox[{"iTry", "\[LessEqual]", "ptCount"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rand\[Eta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "2"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Theta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Phi]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "*", "\[Pi]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       SuperscriptBox["L", "2"], ".", "F"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"L2\[CapitalPsi]First", "=", 
      RowBox[{"L2\[CapitalPsi]", "[", 
       RowBox[{
       "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "choiceN", 
        ",", "choiceM", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L2\[CapitalPsi]Second", "=", 
      RowBox[{"L2\[CapitalPsi]", "[", 
       RowBox[{
       "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "choiceN", 
        ",", "choiceM", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"save", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "rand\[Eta]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", "rand\[Theta]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", "rand\[Phi]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", "choiceN"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}], "=", "choiceM"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iOffset", " ", "=", " ", "5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"now", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "L2\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "2"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "L2\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "3"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "L2\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "4"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "L2\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iTry", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<C:\\\\Users\\\\Vassili Savinov\\\\Dropbox\\\\DARPA_Work\\\\TORH_GIT\\\
\\ToroidalHarmonics\\\\ToroidalHarmonicsDefinition_Convention\\\\L2Psi_term_\
v5.csv\>\"", ",", "numData", ",", "\"\<CSV\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.760866393884334*^9, 3.7608663952761917`*^9}, {
   3.7608664764699373`*^9, 3.760866476794617*^9}, {3.760866731274129*^9, 
   3.760866829554427*^9}, {3.760866906000129*^9, 3.7608669145198784`*^9}, {
   3.760867501156725*^9, 3.76086751089869*^9}, {3.761248963687278*^9, 
   3.7612489638261943`*^9}, {3.7612495036779084`*^9, 3.7612495787918887`*^9}, 
   3.7612505089121504`*^9, 3.761250623394552*^9, {3.761287394117325*^9, 
   3.7612873942332726`*^9}, {3.7612958399159007`*^9, 
   3.7612960622771454`*^9}, {3.761296481874473*^9, 3.761296490100007*^9}, {
   3.761297325208378*^9, 3.7612973884746304`*^9}, {3.761297428243307*^9, 
   3.761297439515546*^9}, {3.7612975965167017`*^9, 3.7612975988192334`*^9}, {
   3.7612987993077803`*^9, 3.7612988056928196`*^9}, {3.761298926028941*^9, 
   3.7612989904329834`*^9}, {3.761299059676083*^9, 3.761299107217651*^9}, {
   3.7612994133159685`*^9, 3.7612994262672243`*^9}, {3.761300453044572*^9, 
   3.7613004894940767`*^9}, {3.761301123381604*^9, 3.7613011267888517`*^9}, {
   3.761301368740631*^9, 3.761301370644134*^9}, {3.761301409221951*^9, 
   3.761301410739333*^9}, {3.761301659373171*^9, 3.7613016615738935`*^9}, {
   3.761302612782086*^9, 3.761302665918494*^9}, {3.7613027712055416`*^9, 
   3.761302771708708*^9}, {3.761303542667015*^9, 3.7613035431032553`*^9}, {
   3.7613036223655357`*^9, 3.7613036247187777`*^9}, {3.7613039129753723`*^9, 
   3.761303913054186*^9}, {3.7613040157014456`*^9, 3.761304023599248*^9}, {
   3.7613041258126106`*^9, 3.7613041262365065`*^9}, {3.7613051119115405`*^9, 
   3.761305112245646*^9}, {3.761305219054417*^9, 3.7613052194304123`*^9}, {
   3.761305349310015*^9, 3.7613053497498317`*^9}, {3.761305417738797*^9, 
   3.761305419054121*^9}, {3.7613056296929417`*^9, 3.761305631844621*^9}, {
   3.761305672332144*^9, 3.7613056727719393`*^9}, 3.761305728642218*^9, {
   3.761305773559492*^9, 3.7613057816473885`*^9}, {3.7613058500860844`*^9, 
   3.7613058787651987`*^9}, {3.761306174486842*^9, 3.7613062680719614`*^9}, {
   3.7613065651616764`*^9, 3.7613065655556526`*^9}, {3.7613067079190245`*^9, 
   3.761306708294142*^9}, {3.7613068858973217`*^9, 3.76130688634423*^9}, {
   3.761307027709037*^9, 3.7613070280868216`*^9}}],

Cell[BoxData[Cell[TextData[StyleBox["Test the full inversion curlL\
\[CapitalPsi] term",
  FontColor->RGBColor[1., 0.5019607843137255, 0.]]], "Text",
  CellChangeTimes->{{3.760856870067711*^9, 3.7608568852104654`*^9}, {
   3.760856918908544*^9, 3.7608569348779273`*^9}, {3.760857046585424*^9, 
   3.760857056910141*^9}, {3.760859827576826*^9, 3.7608598385126495`*^9}, {
   3.7608599456415024`*^9, 3.760859989231761*^9}, {3.7608664456516542`*^9, 
   3.7608664545389132`*^9}, {3.76104140517836*^9, 
   3.761041413417799*^9}}]], "Input",
 CellChangeTimes->{{3.7610414509025135`*^9, 3.761041457654853*^9}, 
   3.761041497643795*^9, {3.761043551546646*^9, 3.7610435728156757`*^9}, {
   3.7610710714895697`*^9, 3.7610711156853657`*^9}, {3.761071377422288*^9, 
   3.7610713955877466`*^9}, {3.761248931356805*^9, 3.761248935456448*^9}, {
   3.7612519754044933`*^9, 3.7612520250536933`*^9}, {3.7612873443064947`*^9, 
   3.761287383132529*^9}, {3.761305723110818*^9, 3.761305724410324*^9}, {
   3.7613072283362994`*^9, 3.76130722875119*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "we", " ", "will", " ", "get", " ", "contributions", " ", "in", " ", "the",
     " ", 
    RowBox[{"L", ".", "F"}], " ", 
    RowBox[{"term", ".", " ", "Note"}], " ", "that", " ", 
    SuperscriptBox["L", "2"], "\[CapitalPsi]"}], "=", 
   RowBox[{"-", 
    RowBox[{"ir", ".", "curlL\[CapitalPsi]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.761295811177617*^9, 3.7612958306349473`*^9}, {
  3.7613060347412863`*^9, 3.76130606385797*^9}, {3.761306115832*^9, 
  3.7613061227654066`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptCount", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceN", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "6"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceM", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "6"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "numData", "]"}], ";", 
   RowBox[{"numData", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "ptCount"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"5", "+", 
         RowBox[{"2", "*", "2"}]}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"iTry", "=", "1"}], ",", 
    RowBox[{"iTry", "\[LessEqual]", "ptCount"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rand\[Eta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "2"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Theta]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Phi]", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "*", "\[Pi]"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"r", ".", "F"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rCurlL\[CapitalPsi]First", "=", 
      RowBox[{"rCurlL\[CapitalPsi]", "[", 
       RowBox[{
       "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "choiceN", 
        ",", "choiceM", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rCurlL\[CapitalPsi]Second", "=", 
      RowBox[{"rCurlL\[CapitalPsi]", "[", 
       RowBox[{
       "rand\[Eta]", ",", "rand\[Theta]", ",", "rand\[Phi]", ",", "choiceN", 
        ",", "choiceM", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"save", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "rand\[Eta]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", "rand\[Theta]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", "rand\[Phi]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", "choiceN"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}], "=", "choiceM"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iOffset", " ", "=", " ", "5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"now", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "rCurlL\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "2"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "rCurlL\[CapitalPsi]First", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "3"}], "]"}], "]"}], "=", 
      RowBox[{"Re", "[", "rCurlL\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"numData", "[", 
        RowBox[{"[", "iTry", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iOffset", "+", "4"}], "]"}], "]"}], "=", 
      RowBox[{"Im", "[", "rCurlL\[CapitalPsi]Second", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"iTry", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<C:\\\\Users\\\\Vassili Savinov\\\\Dropbox\\\\DARPA_Work\\\\TORH_GIT\\\
\\ToroidalHarmonics\\\\ToroidalHarmonicsDefinition_Convention\\\\rCurlLPsi_\
term_v4.csv\>\"", ",", "numData", ",", "\"\<CSV\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.760866393884334*^9, 3.7608663952761917`*^9}, {
   3.7608664764699373`*^9, 3.760866476794617*^9}, {3.760866731274129*^9, 
   3.760866829554427*^9}, {3.760866906000129*^9, 3.7608669145198784`*^9}, {
   3.760867501156725*^9, 3.76086751089869*^9}, {3.761248963687278*^9, 
   3.7612489638261943`*^9}, {3.7612495036779084`*^9, 3.7612495787918887`*^9}, 
   3.7612505089121504`*^9, 3.761250623394552*^9, {3.761287394117325*^9, 
   3.7612873942332726`*^9}, {3.7612958399159007`*^9, 
   3.7612960622771454`*^9}, {3.761296481874473*^9, 3.761296490100007*^9}, {
   3.761297325208378*^9, 3.7612973884746304`*^9}, {3.761297428243307*^9, 
   3.761297439515546*^9}, {3.7612975965167017`*^9, 3.7612975988192334`*^9}, {
   3.7612987993077803`*^9, 3.7612988056928196`*^9}, {3.761298926028941*^9, 
   3.7612989904329834`*^9}, {3.761299059676083*^9, 3.761299107217651*^9}, {
   3.7612994133159685`*^9, 3.7612994262672243`*^9}, {3.761300453044572*^9, 
   3.7613004894940767`*^9}, {3.761301123381604*^9, 3.7613011267888517`*^9}, {
   3.761301368740631*^9, 3.761301370644134*^9}, {3.761301409221951*^9, 
   3.761301410739333*^9}, {3.761301659373171*^9, 3.7613016615738935`*^9}, {
   3.761302612782086*^9, 3.761302665918494*^9}, {3.7613027712055416`*^9, 
   3.761302771708708*^9}, {3.761303542667015*^9, 3.7613035431032553`*^9}, {
   3.7613036223655357`*^9, 3.7613036247187777`*^9}, {3.7613039129753723`*^9, 
   3.761303913054186*^9}, {3.7613040157014456`*^9, 3.761304023599248*^9}, {
   3.7613041258126106`*^9, 3.7613041262365065`*^9}, {3.7613051119115405`*^9, 
   3.761305112245646*^9}, {3.761305219054417*^9, 3.7613052194304123`*^9}, {
   3.761305349310015*^9, 3.7613053497498317`*^9}, {3.761305417738797*^9, 
   3.761305419054121*^9}, {3.7613056296929417`*^9, 3.761305631844621*^9}, {
   3.761305672332144*^9, 3.7613056727719393`*^9}, 3.761305728642218*^9, {
   3.761305773559492*^9, 3.7613057816473885`*^9}, {3.7613058500860844`*^9, 
   3.7613058787651987`*^9}, {3.761306174486842*^9, 3.7613062680719614`*^9}, {
   3.7613065651616764`*^9, 3.7613065655556526`*^9}, {3.7613067079190245`*^9, 
   3.761306708294142*^9}, {3.7613068858973217`*^9, 3.76130688634423*^9}, {
   3.761307027709037*^9, 3.7613070280868216`*^9}, {3.7613072570230684`*^9, 
   3.7613073099742775`*^9}, {3.7613074297320557`*^9, 3.7613074501294117`*^9}, 
   3.7613075448135533`*^9, {3.7613080960316925`*^9, 3.7613080961354427`*^9}, {
   3.7613082512324877`*^9, 3.7613082516267424`*^9}, {3.7613084242387133`*^9, 
   3.76130842461668*^9}, {3.7613085533981776`*^9, 3.7613085538789177`*^9}}]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 121, 2, 45, "Input"],
Cell[682, 24, 193, 4, 68, "Input"],
Cell[CellGroupData[{
Cell[900, 32, 134, 1, 106, "Section"],
Cell[1037, 35, 230, 3, 45, "Text"],
Cell[CellGroupData[{
Cell[1292, 42, 4013, 119, 220, "Input"],
Cell[5308, 163, 1110, 30, 72, "Output"]
}, Open  ]],
Cell[6433, 196, 278, 4, 45, "Text"],
Cell[CellGroupData[{
Cell[6736, 204, 14479, 366, 848, "Input"],
Cell[21218, 572, 3003, 77, 187, "Output"],
Cell[24224, 651, 2113, 54, 165, "Output"],
Cell[26340, 707, 1922, 48, 161, "Output"]
}, Open  ]],
Cell[28277, 758, 315, 4, 45, "Text"],
Cell[28595, 764, 3678, 100, 211, "Input"],
Cell[CellGroupData[{
Cell[32298, 868, 6132, 155, 416, "Input"],
Cell[38433, 1025, 443, 8, 44, "Output"],
Cell[38879, 1035, 943, 22, 72, "Output"],
Cell[39825, 1059, 445, 8, 44, "Output"]
}, Open  ]],
Cell[40285, 1070, 640, 13, 45, "Text"],
Cell[CellGroupData[{
Cell[40950, 1087, 3497, 83, 250, "Input"],
Cell[44450, 1172, 1459, 38, 52, "Output"],
Cell[45912, 1212, 1459, 38, 52, "Output"],
Cell[47374, 1252, 463, 7, 44, "Output"]
}, Open  ]],
Cell[47852, 1262, 438, 6, 45, "Text"],
Cell[48293, 1270, 1838, 49, 152, "Input"],
Cell[50134, 1321, 477, 7, 45, "Text"],
Cell[50614, 1330, 1628, 40, 75, "Input"],
Cell[CellGroupData[{
Cell[52267, 1374, 250, 6, 45, "Input"],
Cell[52520, 1382, 1644, 47, 69, "Output"]
}, Open  ]],
Cell[54179, 1432, 5401, 140, 1003, "Input"],
Cell[59583, 1574, 498, 6, 45, "Text"],
Cell[60084, 1582, 148, 3, 45, "Input"],
Cell[CellGroupData[{
Cell[60257, 1589, 4367, 118, 309, "Input"],
Cell[64627, 1709, 284, 4, 44, "Output"],
Cell[64914, 1715, 284, 4, 44, "Output"],
Cell[65201, 1721, 284, 4, 44, "Output"]
}, Open  ]],
Cell[65500, 1728, 343, 7, 45, "Input"],
Cell[65846, 1737, 2704, 67, 162, "Input"],
Cell[CellGroupData[{
Cell[68575, 1808, 2150, 56, 133, "Input"],
Cell[70728, 1866, 220, 3, 44, "Output"],
Cell[70951, 1871, 220, 3, 44, "Output"],
Cell[71174, 1876, 220, 3, 44, "Output"]
}, Open  ]],
Cell[71409, 1882, 785, 11, 48, "Input"],
Cell[72197, 1895, 7356, 179, 458, "Input"],
Cell[79556, 2076, 1171, 28, 75, "Input"],
Cell[CellGroupData[{
Cell[80752, 2108, 604, 13, 75, "Input"],
Cell[81359, 2123, 4082, 100, 174, "Output"],
Cell[85444, 2225, 26347, 583, 260, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111828, 2813, 955, 22, 45, "Input"],
Cell[112786, 2837, 2566, 72, 130, "Output"]
}, Open  ]],
Cell[115367, 2912, 87, 1, 45, "Input"],
Cell[CellGroupData[{
Cell[115479, 2917, 1606, 40, 133, "Input"],
Cell[117088, 2959, 163, 2, 44, "Output"],
Cell[117254, 2963, 163, 2, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117454, 2970, 13597, 362, 799, "Input"],
Cell[131054, 3334, 660, 11, 44, "Output"],
Cell[131717, 3347, 662, 11, 44, "Output"],
Cell[132382, 3360, 662, 11, 44, "Output"],
Cell[133047, 3373, 662, 11, 44, "Output"],
Cell[133712, 3386, 660, 11, 44, "Output"],
Cell[134375, 3399, 660, 11, 44, "Output"]
}, Open  ]],
Cell[135050, 3413, 779, 12, 48, "Input"],
Cell[CellGroupData[{
Cell[135854, 3429, 2410, 52, 133, "Input"],
Cell[138267, 3483, 3845, 103, 104, "Output"]
}, Open  ]],
Cell[142127, 3589, 177, 3, 45, "Input"],
Cell[142307, 3594, 1499, 42, 75, "Input"],
Cell[CellGroupData[{
Cell[143831, 3640, 262, 5, 45, "Input"],
Cell[144096, 3647, 3525, 114, 87, "Output"]
}, Open  ]],
Cell[147636, 3764, 167, 3, 45, "Input"],
Cell[147806, 3769, 938, 23, 45, "Input"],
Cell[CellGroupData[{
Cell[148769, 3796, 722, 17, 45, "Input"],
Cell[149494, 3815, 3642, 100, 104, "Output"]
}, Open  ]],
Cell[153151, 3918, 165, 3, 45, "Input"],
Cell[CellGroupData[{
Cell[153341, 3925, 268, 6, 45, "Input"],
Cell[153612, 3933, 3498, 114, 87, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157147, 4052, 1215, 29, 75, "Input"],
Cell[158365, 4083, 15552, 415, 589, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173954, 4503, 1356, 34, 75, "Input"],
Cell[175313, 4539, 166, 3, 44, "Output"]
}, Open  ]],
Cell[175494, 4545, 829, 12, 48, "Input"],
Cell[176326, 4559, 1226, 30, 75, "Input"],
Cell[CellGroupData[{
Cell[177577, 4593, 283, 6, 45, "Input"],
Cell[177863, 4601, 308, 5, 44, "Output"]
}, Open  ]],
Cell[178186, 4609, 5615, 143, 974, "Input"],
Cell[183804, 4754, 851, 12, 48, "Input"],
Cell[184658, 4768, 1855, 51, 104, "Input"],
Cell[186516, 4821, 3894, 90, 309, "Input"],
Cell[CellGroupData[{
Cell[190435, 4915, 719, 16, 45, "Input"],
Cell[191157, 4933, 3247, 98, 122, "Output"]
}, Open  ]],
Cell[194419, 5034, 930, 14, 48, "Input"],
Cell[195352, 5050, 311, 7, 45, "Input"],
Cell[195666, 5059, 9437, 225, 1264, "Input"],
Cell[205106, 5286, 976, 14, 48, "Input"],
Cell[206085, 5302, 543, 13, 45, "Input"],
Cell[206631, 5317, 646, 16, 75, "Input"],
Cell[CellGroupData[{
Cell[207302, 5337, 249, 6, 45, "Input"],
Cell[207554, 5345, 260, 4, 44, "Output"]
}, Open  ]],
Cell[207829, 5352, 7378, 169, 955, "Input"],
Cell[215210, 5523, 1031, 15, 48, "Input"],
Cell[216244, 5540, 543, 13, 45, "Input"],
Cell[216790, 5555, 7725, 173, 1031, "Input"]
}, Open  ]]
}
]
*)

